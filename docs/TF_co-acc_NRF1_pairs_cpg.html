<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="XSun" />

<meta name="date" content="2025-09-09" />

<title>Checking how CpG methylation affects TF binding</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.22/datatables.js"></script>
<link href="site_libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">fiberseq</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/xsun1229/fiberseq">
    <span class="fab fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Checking how CpG methylation affects TF
binding</h1>
<h4 class="author">XSun</h4>
<h4 class="date">2025-09-09</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2025-09-10
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 6
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 1
</p>
<p>
<strong>Knit directory:</strong> <code>fiberseq/</code> <span
class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.0). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguncommittedchanges">
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> <strong>R Markdown file:</strong> uncommitted
changes </a>
</p>
</div>
<div id="strongRMarkdownfilestronguncommittedchanges"
class="panel-collapse collapse">
<div class="panel-body">
<p>The R Markdown is untracked by Git. To know which version of the R
Markdown file created these results, you’ll want to first commit it to
the Git repo. If you’re still working on the analysis, you can ignore
this warning. When you’re finished, you can run
<code>wflow_publish</code> to commit the R Markdown file and build the
HTML.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20250831code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20250831)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20250831code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20250831)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomxsun1229fiberseqtree07352c1fd8b748a8fa7e3e4889097f4883642582targetblank07352c1a">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/xsun1229/fiberseq/tree/07352c1fd8b748a8fa7e3e4889097f4883642582" target="_blank">07352c1</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcomxsun1229fiberseqtree07352c1fd8b748a8fa7e3e4889097f4883642582targetblank07352c1a"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/xsun1229/fiberseq/tree/07352c1fd8b748a8fa7e3e4889097f4883642582" target="_blank">07352c1</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Untracked files:
    Untracked:  analysis/TF_co-acc_NRF1_pairs_cpg.Rmd

Unstaged changes:
    Modified:   analysis/TF_co-acc_NRF1_pairs.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">
<p>
There are no past versions. Publish this analysis with
<code>wflow_publish()</code> to start tracking its development.
</p>
<hr>
</div>
</div>
</div>
<p>We check how CpG methylation affects TF binding here.</p>
<p>We focus on the regions selected here: <a
href="https://xsun1229.github.io/fiberseq/TF_co-acc_NRF1_pairs.html"
class="uri">https://xsun1229.github.io/fiberseq/TF_co-acc_NRF1_pairs.html</a></p>
<div id="examples" class="section level1">
<h1>Examples</h1>
<p>We first illustrate the workflow using 2 examples.</p>
<div id="chr10122879000-122880300" class="section level2">
<h2>chr10:122879000-122880300</h2>
<p>The first example is region chr10:122879500–122879700, focusing on
the motif chr10:122879629–122879640.</p>
<pre class="r"><code>library(data.table)
library(reshape2)
library(GenomicRanges)
library(ggplot2)
library(tidyverse)
library(gridExtra)
library(Biostrings)

source(&quot;/project/spott/kevinluo/Fiber_seq/fiberhub/code/process_fiberseq_data.R&quot;)
source(&quot;/project/spott/kevinluo/Fiber_seq/fiberhub/code/plots.R&quot;)

test_range_str &lt;- &quot;chr10:122879000-122880300&quot;
plot_name &lt;- &quot;NRF1_pairs_LCL_18508_chr10:122879000-122880300&quot;
result_dir &lt;- &quot;/project/xinhe/xsun/fiberseq/1.TFs/plot_region/results/NRF1_pairs//NRF1_pairs_LCL_18508_chr10:122879000-122880300/parsed&quot;

region &lt;- get_region(result_dir)
subtitle &lt;- sprintf(&quot;%s:%s-%s&quot;, region$chr, region$start, region$end)

# motif coordinates
start_motif1 &lt;- 122879629
end_motif1   &lt;- 122879640

region_plot &lt;- list(chr =&quot;chr10&quot;,
                    start = 122879500,
                    end = 122879800)

res &lt;- try(assemble_region_result(result_dir,
                       filter_fire_reads = FALSE,
                       cover_region_only = FALSE,
                       select_A_only = FALSE,
                       split_haplotype = FALSE,
                       highlight_window = data.frame(start=c(start_motif1), end=c(end_motif1)),
                       color_highlight_window = &quot;#44d6d8ff&quot;,
                       plot_name = plot_name,region = region_plot,
                       subtitle = subtitle)
  )</code></pre>
<pre><code>Assembling region result...
Load fiberHMM_res from result_dir 
Clustering reads...
51 reads.</code></pre>
<pre class="r"><code>gg &lt;- res$gg

print(cowplot::plot_grid(
  gg$pileup,
  gg$dimelo_reads,
  gg$fire_fdr,
  gg$fire_reads,
  gg$fiberHMM,
  ncol = 1,
  rel_heights = c(4,8,2,8,8),
  align = &quot;v&quot;,
  axis = &quot;b&quot;
))</code></pre>
<p><img src="figure/TF_co-acc_NRF1_pairs_cpg.Rmd/unnamed-chunk-1-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Next, we identify CpG positions within this motif. The CpG positions
are extracted from the corresponding .fa files.</p>
<pre class="r"><code>seq_region &lt;- readDNAStringSet(file.path(result_dir,&quot;/region.fa&quot;))
dna_seq &lt;- seq_region[[1]]
cpg_rel_pos &lt;- start(matchPattern(&quot;CG&quot;, dna_seq))
header &lt;- names(seq_region)       # e.g. &quot;chr10:122879000-122880300&quot;
parts &lt;- strsplit(header, &quot;[:-]&quot;)[[1]]
chrom &lt;- parts[1]
region_start &lt;- as.integer(parts[2])
cpg_df &lt;- data.frame(
  chrom = chrom,
  position = region_start + cpg_rel_pos - 1
)
cpg_df_inmotif &lt;- cpg_df[cpg_df$position &gt;= start_motif1 &amp; cpg_df$position &lt;= end_motif1,]

rid_motif1 &lt;- as.character(res$rids_df$RID[res$rids_df$start &lt;= end_motif1 &amp; res$rids_df$end &gt;= start_motif1])

rid_motifsite_mat &lt;- matrix(
  NA, 
  nrow = length(rid_motif1), 
  ncol = length(start_motif1:end_motif1),
  dimnames = list(rid_motif1, as.character(start_motif1:end_motif1))
)
rid_motifsite_methy &lt;- rid_motifsite_mat

# Mark CpG positions
rid_motifsite_mat[,colnames(rid_motifsite_mat) %in% as.character(cpg_df_inmotif$position)] &lt;- &quot;CpG&quot;

DT::datatable(rid_motifsite_mat,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;CpG positions in the motif for each read&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-55d484e2ce688c3024c2" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-55d484e2ce688c3024c2">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">CpG positions in the motif for each read<\/caption>","data":[["m64403e_220914_215953/10224171/ccs","m64403e_220914_215953/131138511/ccs","m64403e_220914_215953/145424492/ccs","m64403e_220914_215953/160956839/ccs","m64403e_220916_085351/167248661/ccs","m64403e_220916_085351/44826786/ccs","m64403e_220916_085351/60359354/ccs","m64403e_230429_051256/100206673/ccs","m64403e_230429_051256/104334146/ccs","m64403e_230429_051256/110887057/ccs","m64403e_230429_051256/127140782/ccs","m64403e_230429_051256/160170233/ccs","m64403e_230429_051256/161743525/ccs","m64403e_230429_051256/166265803/ccs","m64403e_230429_051256/174983949/ccs","m64403e_230429_051256/176229130/ccs","m64403e_230429_051256/51839974/ccs","m64403e_230429_051256/61541106/ccs","m64403e_230429_051256/74188293/ccs","m64403e_230429_051256/79496012/ccs","m64403e_230429_051256/90570788/ccs","m64403e_230430_142929/11536078/ccs","m64403e_230430_142929/116064882/ccs","m64403e_230430_142929/116523285/ccs","m64403e_230430_142929/134087619/ccs","m64403e_230430_142929/142540800/ccs","m64403e_230430_142929/154733326/ccs","m64403e_230430_142929/167905710/ccs","m64403e_230430_142929/172949738/ccs","m64403e_230430_142929/18089817/ccs","m64403e_230430_142929/33359281/ccs","m64403e_230430_142929/36636491/ccs","m64403e_230430_142929/54789941/ccs","m64403e_230430_142929/66914126/ccs","m64403e_230430_142929/67109026/ccs","m64403e_230501_235831/104532797/ccs","m64403e_230501_235831/12585160/ccs","m64403e_230501_235831/142083343/ccs","m64403e_230501_235831/145295211/ccs","m64403e_230501_235831/152570718/ccs","m64403e_230501_235831/171377356/ccs","m64403e_230501_235831/20448472/ccs","m64403e_230501_235831/2885161/ccs","m64403e_230501_235831/40042813/ccs","m64403e_230501_235831/45614164/ccs","m64403e_230501_235831/52431322/ccs","m64403e_230501_235831/63244851/ccs","m64403e_230501_235831/75238141/ccs","m64403e_230501_235831/8980332/ccs"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>122879629<\/th>\n      <th>122879630<\/th>\n      <th>122879631<\/th>\n      <th>122879632<\/th>\n      <th>122879633<\/th>\n      <th>122879634<\/th>\n      <th>122879635<\/th>\n      <th>122879636<\/th>\n      <th>122879637<\/th>\n      <th>122879638<\/th>\n      <th>122879639<\/th>\n      <th>122879640<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>We then retrieve methylation information from res$read.</p>
<pre class="r"><code># Fill methylation
reads_cpg &lt;- res$reads[res$reads$base == &quot;CG&quot;,]
reads_cpg$RID &lt;- as.character(reads_cpg$RID)

idx &lt;- which(reads_cpg$RID %in% rownames(rid_motifsite_methy) &amp;
               reads_cpg$ref_position %in% colnames(rid_motifsite_methy))

for (j in idx) {
  rid_motifsite_methy[reads_cpg$RID[j], as.character(reads_cpg$ref_position[j])] &lt;- reads_cpg$mod_qual[j]
}

DT::datatable(rid_motifsite_methy,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;Methylation quality score for each read&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-0c375f72d786c94bb27a" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-0c375f72d786c94bb27a">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">Methylation quality score for each read<\/caption>","data":[["m64403e_220914_215953/10224171/ccs","m64403e_220914_215953/131138511/ccs","m64403e_220914_215953/145424492/ccs","m64403e_220914_215953/160956839/ccs","m64403e_220916_085351/167248661/ccs","m64403e_220916_085351/44826786/ccs","m64403e_220916_085351/60359354/ccs","m64403e_230429_051256/100206673/ccs","m64403e_230429_051256/104334146/ccs","m64403e_230429_051256/110887057/ccs","m64403e_230429_051256/127140782/ccs","m64403e_230429_051256/160170233/ccs","m64403e_230429_051256/161743525/ccs","m64403e_230429_051256/166265803/ccs","m64403e_230429_051256/174983949/ccs","m64403e_230429_051256/176229130/ccs","m64403e_230429_051256/51839974/ccs","m64403e_230429_051256/61541106/ccs","m64403e_230429_051256/74188293/ccs","m64403e_230429_051256/79496012/ccs","m64403e_230429_051256/90570788/ccs","m64403e_230430_142929/11536078/ccs","m64403e_230430_142929/116064882/ccs","m64403e_230430_142929/116523285/ccs","m64403e_230430_142929/134087619/ccs","m64403e_230430_142929/142540800/ccs","m64403e_230430_142929/154733326/ccs","m64403e_230430_142929/167905710/ccs","m64403e_230430_142929/172949738/ccs","m64403e_230430_142929/18089817/ccs","m64403e_230430_142929/33359281/ccs","m64403e_230430_142929/36636491/ccs","m64403e_230430_142929/54789941/ccs","m64403e_230430_142929/66914126/ccs","m64403e_230430_142929/67109026/ccs","m64403e_230501_235831/104532797/ccs","m64403e_230501_235831/12585160/ccs","m64403e_230501_235831/142083343/ccs","m64403e_230501_235831/145295211/ccs","m64403e_230501_235831/152570718/ccs","m64403e_230501_235831/171377356/ccs","m64403e_230501_235831/20448472/ccs","m64403e_230501_235831/2885161/ccs","m64403e_230501_235831/40042813/ccs","m64403e_230501_235831/45614164/ccs","m64403e_230501_235831/52431322/ccs","m64403e_230501_235831/63244851/ccs","m64403e_230501_235831/75238141/ccs","m64403e_230501_235831/8980332/ccs"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,0.8066406,null,null,0.6894531,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.7167969,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.8886719,0.7246094,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9042969,null,null,null,null,null,null,null,0.8457031,null,null,null,null,null,null,null,null,null,null,0.7597656,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,0.7636719,null,null,null,null,null,null,null,null,null,0.7050781,null,null,null,null,null,0.9980469,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.9746094,null,null,0.8808594,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>122879629<\/th>\n      <th>122879630<\/th>\n      <th>122879631<\/th>\n      <th>122879632<\/th>\n      <th>122879633<\/th>\n      <th>122879634<\/th>\n      <th>122879635<\/th>\n      <th>122879636<\/th>\n      <th>122879637<\/th>\n      <th>122879638<\/th>\n      <th>122879639<\/th>\n      <th>122879640<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>stopifnot(identical(dimnames(rid_motifsite_methy), dimnames(rid_motifsite_mat)))</code></pre>
<p>By combining the CpG position matrix with the methylation quality
matrix, we annotate methylated sites as mCpG. A read is classified as
mCpG if it contains at least one methylated CpG.</p>
<pre class="r"><code># Combine CpG &amp; methylation
rid_motifsite_combined &lt;- ifelse(
  !is.na(rid_motifsite_methy) &amp; !is.na(rid_motifsite_mat), 
  &quot;mCpG&quot;,
  ifelse(!is.na(rid_motifsite_mat), &quot;CpG&quot;, NA)
)

DT::datatable(rid_motifsite_combined,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;Methylation annotation for each read&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-9fa6da26214ebfd05e61" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9fa6da26214ebfd05e61">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">Methylation annotation for each read<\/caption>","data":[["m64403e_220914_215953/10224171/ccs","m64403e_220914_215953/131138511/ccs","m64403e_220914_215953/145424492/ccs","m64403e_220914_215953/160956839/ccs","m64403e_220916_085351/167248661/ccs","m64403e_220916_085351/44826786/ccs","m64403e_220916_085351/60359354/ccs","m64403e_230429_051256/100206673/ccs","m64403e_230429_051256/104334146/ccs","m64403e_230429_051256/110887057/ccs","m64403e_230429_051256/127140782/ccs","m64403e_230429_051256/160170233/ccs","m64403e_230429_051256/161743525/ccs","m64403e_230429_051256/166265803/ccs","m64403e_230429_051256/174983949/ccs","m64403e_230429_051256/176229130/ccs","m64403e_230429_051256/51839974/ccs","m64403e_230429_051256/61541106/ccs","m64403e_230429_051256/74188293/ccs","m64403e_230429_051256/79496012/ccs","m64403e_230429_051256/90570788/ccs","m64403e_230430_142929/11536078/ccs","m64403e_230430_142929/116064882/ccs","m64403e_230430_142929/116523285/ccs","m64403e_230430_142929/134087619/ccs","m64403e_230430_142929/142540800/ccs","m64403e_230430_142929/154733326/ccs","m64403e_230430_142929/167905710/ccs","m64403e_230430_142929/172949738/ccs","m64403e_230430_142929/18089817/ccs","m64403e_230430_142929/33359281/ccs","m64403e_230430_142929/36636491/ccs","m64403e_230430_142929/54789941/ccs","m64403e_230430_142929/66914126/ccs","m64403e_230430_142929/67109026/ccs","m64403e_230501_235831/104532797/ccs","m64403e_230501_235831/12585160/ccs","m64403e_230501_235831/142083343/ccs","m64403e_230501_235831/145295211/ccs","m64403e_230501_235831/152570718/ccs","m64403e_230501_235831/171377356/ccs","m64403e_230501_235831/20448472/ccs","m64403e_230501_235831/2885161/ccs","m64403e_230501_235831/40042813/ccs","m64403e_230501_235831/45614164/ccs","m64403e_230501_235831/52431322/ccs","m64403e_230501_235831/63244851/ccs","m64403e_230501_235831/75238141/ccs","m64403e_230501_235831/8980332/ccs"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["CpG","CpG","CpG","mCpG","CpG","CpG","mCpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","mCpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","mCpG","mCpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["CpG","CpG","CpG","CpG","CpG","CpG","mCpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","mCpG","CpG","CpG","CpG","CpG","CpG","mCpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","mCpG","CpG","CpG","mCpG","CpG","CpG","CpG","CpG"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>122879629<\/th>\n      <th>122879630<\/th>\n      <th>122879631<\/th>\n      <th>122879632<\/th>\n      <th>122879633<\/th>\n      <th>122879634<\/th>\n      <th>122879635<\/th>\n      <th>122879636<\/th>\n      <th>122879637<\/th>\n      <th>122879638<\/th>\n      <th>122879639<\/th>\n      <th>122879640<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>If a read has at least one mCpG, we annotate this read as mCpG</p>
<pre class="r"><code>RID_cpg &lt;- data.frame(
  RID = rownames(rid_motifsite_combined),
  status = apply(rid_motifsite_combined, 1, function(x) {
    if (&quot;mCpG&quot; %in% x) &quot;mCpG&quot;
    else if (all(na.omit(x) == &quot;CpG&quot;)) &quot;CpG&quot;
    else NA
  }),
  row.names = NULL
)

DT::datatable(RID_cpg,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;Methylation info for each read&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-1b1a8ec0941961691c13" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1b1a8ec0941961691c13">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">Methylation info for each read<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49"],["m64403e_220914_215953/10224171/ccs","m64403e_220914_215953/131138511/ccs","m64403e_220914_215953/145424492/ccs","m64403e_220914_215953/160956839/ccs","m64403e_220916_085351/167248661/ccs","m64403e_220916_085351/44826786/ccs","m64403e_220916_085351/60359354/ccs","m64403e_230429_051256/100206673/ccs","m64403e_230429_051256/104334146/ccs","m64403e_230429_051256/110887057/ccs","m64403e_230429_051256/127140782/ccs","m64403e_230429_051256/160170233/ccs","m64403e_230429_051256/161743525/ccs","m64403e_230429_051256/166265803/ccs","m64403e_230429_051256/174983949/ccs","m64403e_230429_051256/176229130/ccs","m64403e_230429_051256/51839974/ccs","m64403e_230429_051256/61541106/ccs","m64403e_230429_051256/74188293/ccs","m64403e_230429_051256/79496012/ccs","m64403e_230429_051256/90570788/ccs","m64403e_230430_142929/11536078/ccs","m64403e_230430_142929/116064882/ccs","m64403e_230430_142929/116523285/ccs","m64403e_230430_142929/134087619/ccs","m64403e_230430_142929/142540800/ccs","m64403e_230430_142929/154733326/ccs","m64403e_230430_142929/167905710/ccs","m64403e_230430_142929/172949738/ccs","m64403e_230430_142929/18089817/ccs","m64403e_230430_142929/33359281/ccs","m64403e_230430_142929/36636491/ccs","m64403e_230430_142929/54789941/ccs","m64403e_230430_142929/66914126/ccs","m64403e_230430_142929/67109026/ccs","m64403e_230501_235831/104532797/ccs","m64403e_230501_235831/12585160/ccs","m64403e_230501_235831/142083343/ccs","m64403e_230501_235831/145295211/ccs","m64403e_230501_235831/152570718/ccs","m64403e_230501_235831/171377356/ccs","m64403e_230501_235831/20448472/ccs","m64403e_230501_235831/2885161/ccs","m64403e_230501_235831/40042813/ccs","m64403e_230501_235831/45614164/ccs","m64403e_230501_235831/52431322/ccs","m64403e_230501_235831/63244851/ccs","m64403e_230501_235831/75238141/ccs","m64403e_230501_235831/8980332/ccs"],["CpG","CpG","CpG","mCpG","CpG","CpG","mCpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","mCpG","CpG","CpG","CpG","CpG","mCpG","mCpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","mCpG","mCpG","CpG","CpG","mCpG","CpG","CpG","CpG","CpG"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>RID<\/th>\n      <th>status<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>This results in two groups of reads: those containing mCpG and those
without methylation. We then compare footprint frequencies between the
two groups.</p>
<p>We restrict the analysis to reads without nucleosome footprints,
since transcription factors cannot bind when the motif is occupied by a
nucleosome.</p>
<pre class="r"><code>fps &lt;- res$fiberHMM_fps_infire
fps_TF &lt;- fps[fps$class %in% c(&quot;&lt; 40bp&quot;, &quot;40-60bp&quot;),]
fps_gr &lt;- GRanges(fps_TF$chr, IRanges(fps_TF$start, fps_TF$end), strand=fps_TF$strand)
mcols(fps_gr) &lt;- fps_TF[, !(names(fps_TF) %in% c(&quot;chr&quot;,&quot;start&quot;,&quot;end&quot;,&quot;strand&quot;))]

hw &lt;- GRanges(region$chr, IRanges(start_motif1, end_motif1))
fps_gr &lt;- fps_gr[width(pintersect(fps_gr, hw)) &gt; 0]
rid_motif1_fp &lt;- as.character(fps_gr$RID)

fps &lt;- res$fiberHMM_fps
fps_nucl &lt;- fps[fps$size %in% c(&quot;&gt; 100bp&quot;, &quot;60-100bp&quot;),]
fps_gr_nucl &lt;- GRanges(fps_nucl$chr, IRanges(fps_nucl$fp_blockStarts, fps_nucl$fp_blockEnds))
mcols(fps_gr_nucl) &lt;- fps_nucl[, !(names(fps_nucl) %in% c(&quot;chr&quot;,&quot;start&quot;,&quot;end&quot;))]
fps_gr_nucl &lt;- fps_gr_nucl[width(pintersect(fps_gr_nucl, hw, ignore.strand = T)) &gt; 0]
rid_fps_nucl &lt;- as.character(fps_gr_nucl$RID)

# filter rid sets
rid_motif1_without_nucl &lt;- setdiff(rid_motif1, rid_fps_nucl)
RIDs_overlap_both &lt;- intersect(rid_motif1_without_nucl, RID_cpg$RID)

RIDs_access.df &lt;- data.frame(
  RID = RIDs_overlap_both,
  TF = RIDs_overlap_both %in% rid_motif1_fp,
  mCpG = RIDs_overlap_both %in% RID_cpg$RID[RID_cpg$status==&quot;mCpG&quot;]
)

RIDs_access.df$TF &lt;- factor(RIDs_access.df$TF, levels=c(FALSE, TRUE))
RIDs_access.df$mCpG &lt;- factor(RIDs_access.df$mCpG, levels=c(FALSE, TRUE))

print(RIDs_access.df)</code></pre>
<pre><code>                                   RID    TF  mCpG
1  m64403e_220914_215953/145424492/ccs FALSE FALSE
2  m64403e_220914_215953/160956839/ccs  TRUE  TRUE
3  m64403e_230429_051256/166265803/ccs  TRUE FALSE
4  m64403e_230429_051256/174983949/ccs  TRUE FALSE
5   m64403e_230429_051256/74188293/ccs  TRUE FALSE
6   m64403e_230429_051256/79496012/ccs  TRUE FALSE
7  m64403e_230430_142929/116523285/ccs  TRUE FALSE
8  m64403e_230430_142929/134087619/ccs  TRUE FALSE
9  m64403e_230430_142929/142540800/ccs  TRUE FALSE
10 m64403e_230430_142929/154733326/ccs  TRUE FALSE
11 m64403e_230430_142929/172949738/ccs  TRUE FALSE
12  m64403e_230430_142929/33359281/ccs  TRUE FALSE
13  m64403e_230430_142929/67109026/ccs FALSE FALSE
14 m64403e_230501_235831/104532797/ccs  TRUE FALSE
15 m64403e_230501_235831/142083343/ccs  TRUE FALSE
16 m64403e_230501_235831/145295211/ccs  TRUE FALSE
17   m64403e_230501_235831/2885161/ccs  TRUE FALSE
18  m64403e_230501_235831/52431322/ccs  TRUE FALSE
19  m64403e_230501_235831/75238141/ccs  TRUE FALSE
20   m64403e_230501_235831/8980332/ccs  TRUE FALSE</code></pre>
<pre class="r"><code>contingency_table &lt;- table(RIDs_access.df[,c(&quot;TF&quot;,&quot;mCpG&quot;)]) 
prop_col &lt;- round(prop.table(contingency_table, margin = 2) * 100,2)

print(contingency_table)</code></pre>
<pre><code>       mCpG
TF      FALSE TRUE
  FALSE     2    0
  TRUE     17    1</code></pre>
<pre class="r"><code>print(prop_col)</code></pre>
<pre><code>       mCpG
TF       FALSE   TRUE
  FALSE  10.53   0.00
  TRUE   89.47 100.00</code></pre>
</div>
<div id="chr7101217498-101218700" class="section level2">
<h2>chr7:101217498-101218700</h2>
<p>The second example is region chr7:101217498-101218700, focusing on
the motif chr7:101218054-101218265.</p>
<pre class="r"><code>library(data.table)
library(reshape2)
library(GenomicRanges)
library(ggplot2)
library(tidyverse)
library(gridExtra)
library(Biostrings)

source(&quot;/project/spott/kevinluo/Fiber_seq/fiberhub/code/process_fiberseq_data.R&quot;)
source(&quot;/project/spott/kevinluo/Fiber_seq/fiberhub/code/plots.R&quot;)

test_range_str &lt;- &quot;chr7:101217500-101218700&quot;
plot_name &lt;- &quot;NRF1_pairs_LCL_18508_chr7:101217500-101218700&quot;
result_dir &lt;- &quot;/project/xinhe/xsun/fiberseq/1.TFs/plot_region/results/NRF1_pairs//NRF1_pairs_LCL_18508_chr7:101217500-101218700/parsed&quot;

region &lt;- get_region(result_dir)
subtitle &lt;- sprintf(&quot;%s:%s-%s&quot;, region$chr, region$start, region$end)

# motif coordinates
start_motif1 &lt;- 101218154
end_motif1   &lt;- 101218165

region_plot &lt;- list(chr =&quot;chr10&quot;,
                    start = 101218000,
                    end = 101218300)

res &lt;- try(assemble_region_result(result_dir,
                       filter_fire_reads = FALSE,
                       cover_region_only = FALSE,
                       select_A_only = FALSE,
                       split_haplotype = FALSE,
                       highlight_window = data.frame(start=c(start_motif1), end=c(end_motif1)),
                       color_highlight_window = &quot;#44d6d8ff&quot;,
                       plot_name = plot_name,region = region_plot,
                       subtitle = subtitle)
  )</code></pre>
<pre><code>Assembling region result...
Load fiberHMM_res from result_dir 
Clustering reads...
40 reads.</code></pre>
<pre class="r"><code>gg &lt;- res$gg

print(cowplot::plot_grid(
  gg$pileup,
  gg$dimelo_reads,
  gg$fire_fdr,
  gg$fire_reads,
  gg$fiberHMM,
  ncol = 1,
  rel_heights = c(4,8,2,8,8),
  align = &quot;v&quot;,
  axis = &quot;b&quot;
))</code></pre>
<p><img src="figure/TF_co-acc_NRF1_pairs_cpg.Rmd/unnamed-chunk-7-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Next, we identify CpG positions within this motif. The CpG positions
are extracted from the corresponding .fa files.</p>
<pre class="r"><code>seq_region &lt;- readDNAStringSet(file.path(result_dir,&quot;/region.fa&quot;))
dna_seq &lt;- seq_region[[1]]
cpg_rel_pos &lt;- start(matchPattern(&quot;CG&quot;, dna_seq))
header &lt;- names(seq_region)       
parts &lt;- strsplit(header, &quot;[:-]&quot;)[[1]]
chrom &lt;- parts[1]
region_start &lt;- as.integer(parts[2])
cpg_df &lt;- data.frame(
  chrom = chrom,
  position = region_start + cpg_rel_pos - 1
)
cpg_df_inmotif &lt;- cpg_df[cpg_df$position &gt;= start_motif1 &amp; cpg_df$position &lt;= end_motif1,]

rid_motif1 &lt;- as.character(res$rids_df$RID[res$rids_df$start &lt;= end_motif1 &amp; res$rids_df$end &gt;= start_motif1])

rid_motifsite_mat &lt;- matrix(
  NA, 
  nrow = length(rid_motif1), 
  ncol = length(start_motif1:end_motif1),
  dimnames = list(rid_motif1, as.character(start_motif1:end_motif1))
)
rid_motifsite_methy &lt;- rid_motifsite_mat

# Mark CpG positions
rid_motifsite_mat[,colnames(rid_motifsite_mat) %in% as.character(cpg_df_inmotif$position)] &lt;- &quot;CpG&quot;

DT::datatable(rid_motifsite_mat,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;CpG positions in the motif for each read&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-d3bdb3a70b69fe9ab76d" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d3bdb3a70b69fe9ab76d">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">CpG positions in the motif for each read<\/caption>","data":[["m64403e_220914_215953/148177310/ccs","m64403e_220916_085351/110430727/ccs","m64403e_220916_085351/134087216/ccs","m64403e_220916_085351/162596995/ccs","m64403e_220916_085351/163709447/ccs","m64403e_220916_085351/23528864/ccs","m64403e_230429_051256/115279350/ccs","m64403e_230429_051256/161808431/ccs","m64403e_230429_051256/19532027/ccs","m64403e_230429_051256/65341726/ccs","m64403e_230429_051256/9373994/ccs","m64403e_230430_142929/117573517/ccs","m64403e_230430_142929/121570605/ccs","m64403e_230430_142929/136514381/ccs","m64403e_230430_142929/142476930/ccs","m64403e_230430_142929/147260103/ccs","m64403e_230430_142929/198252/ccs","m64403e_230430_142929/47777236/ccs","m64403e_230430_142929/53281662/ccs","m64403e_230430_142929/60099385/ccs","m64403e_230430_142929/64096340/ccs","m64403e_230430_142929/64356664/ccs","m64403e_230430_142929/65866578/ccs","m64403e_230430_142929/67569652/ccs","m64403e_230430_142929/72876178/ccs","m64403e_230430_142929/83886698/ccs","m64403e_230430_142929/8978946/ccs","m64403e_230430_142929/90047919/ccs","m64403e_230430_142929/9177283/ccs","m64403e_230430_142929/9765817/ccs","m64403e_230501_235831/104661083/ccs","m64403e_230501_235831/114950349/ccs","m64403e_230501_235831/133760000/ccs","m64403e_230501_235831/168493987/ccs","m64403e_230501_235831/17892932/ccs","m64403e_230501_235831/25232239/ccs","m64403e_230501_235831/28574000/ccs","m64403e_230501_235831/37749761/ccs","m64403e_230501_235831/75172147/ccs"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>101218154<\/th>\n      <th>101218155<\/th>\n      <th>101218156<\/th>\n      <th>101218157<\/th>\n      <th>101218158<\/th>\n      <th>101218159<\/th>\n      <th>101218160<\/th>\n      <th>101218161<\/th>\n      <th>101218162<\/th>\n      <th>101218163<\/th>\n      <th>101218164<\/th>\n      <th>101218165<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>We then retrieve methylation information from res$read.</p>
<pre class="r"><code># Fill methylation
reads_cpg &lt;- res$reads[res$reads$base == &quot;CG&quot;,]
reads_cpg$RID &lt;- as.character(reads_cpg$RID)

idx &lt;- which(reads_cpg$RID %in% rownames(rid_motifsite_methy) &amp;
               reads_cpg$ref_position %in% colnames(rid_motifsite_methy))

for (j in idx) {
  rid_motifsite_methy[reads_cpg$RID[j], as.character(reads_cpg$ref_position[j])] &lt;- reads_cpg$mod_qual[j]
}

DT::datatable(rid_motifsite_methy,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;Methylation quality score for each read&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-e41253b73217ca07c332" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e41253b73217ca07c332">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">Methylation quality score for each read<\/caption>","data":[["m64403e_220914_215953/148177310/ccs","m64403e_220916_085351/110430727/ccs","m64403e_220916_085351/134087216/ccs","m64403e_220916_085351/162596995/ccs","m64403e_220916_085351/163709447/ccs","m64403e_220916_085351/23528864/ccs","m64403e_230429_051256/115279350/ccs","m64403e_230429_051256/161808431/ccs","m64403e_230429_051256/19532027/ccs","m64403e_230429_051256/65341726/ccs","m64403e_230429_051256/9373994/ccs","m64403e_230430_142929/117573517/ccs","m64403e_230430_142929/121570605/ccs","m64403e_230430_142929/136514381/ccs","m64403e_230430_142929/142476930/ccs","m64403e_230430_142929/147260103/ccs","m64403e_230430_142929/198252/ccs","m64403e_230430_142929/47777236/ccs","m64403e_230430_142929/53281662/ccs","m64403e_230430_142929/60099385/ccs","m64403e_230430_142929/64096340/ccs","m64403e_230430_142929/64356664/ccs","m64403e_230430_142929/65866578/ccs","m64403e_230430_142929/67569652/ccs","m64403e_230430_142929/72876178/ccs","m64403e_230430_142929/83886698/ccs","m64403e_230430_142929/8978946/ccs","m64403e_230430_142929/90047919/ccs","m64403e_230430_142929/9177283/ccs","m64403e_230430_142929/9765817/ccs","m64403e_230501_235831/104661083/ccs","m64403e_230501_235831/114950349/ccs","m64403e_230501_235831/133760000/ccs","m64403e_230501_235831/168493987/ccs","m64403e_230501_235831/17892932/ccs","m64403e_230501_235831/25232239/ccs","m64403e_230501_235831/28574000/ccs","m64403e_230501_235831/37749761/ccs","m64403e_230501_235831/75172147/ccs"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>101218154<\/th>\n      <th>101218155<\/th>\n      <th>101218156<\/th>\n      <th>101218157<\/th>\n      <th>101218158<\/th>\n      <th>101218159<\/th>\n      <th>101218160<\/th>\n      <th>101218161<\/th>\n      <th>101218162<\/th>\n      <th>101218163<\/th>\n      <th>101218164<\/th>\n      <th>101218165<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>stopifnot(identical(dimnames(rid_motifsite_methy), dimnames(rid_motifsite_mat)))</code></pre>
<p>By combining the CpG position matrix with the methylation quality
matrix, we annotate methylated sites as mCpG. A read is classified as
mCpG if it contains at least one methylated CpG.</p>
<pre class="r"><code># Combine CpG &amp; methylation
rid_motifsite_combined &lt;- ifelse(
  !is.na(rid_motifsite_methy) &amp; !is.na(rid_motifsite_mat), 
  &quot;mCpG&quot;,
  ifelse(!is.na(rid_motifsite_mat), &quot;CpG&quot;, NA)
)

DT::datatable(rid_motifsite_combined,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;Methylation annotation for each read&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-6b35d4872c33fe5849ab" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6b35d4872c33fe5849ab">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">Methylation annotation for each read<\/caption>","data":[["m64403e_220914_215953/148177310/ccs","m64403e_220916_085351/110430727/ccs","m64403e_220916_085351/134087216/ccs","m64403e_220916_085351/162596995/ccs","m64403e_220916_085351/163709447/ccs","m64403e_220916_085351/23528864/ccs","m64403e_230429_051256/115279350/ccs","m64403e_230429_051256/161808431/ccs","m64403e_230429_051256/19532027/ccs","m64403e_230429_051256/65341726/ccs","m64403e_230429_051256/9373994/ccs","m64403e_230430_142929/117573517/ccs","m64403e_230430_142929/121570605/ccs","m64403e_230430_142929/136514381/ccs","m64403e_230430_142929/142476930/ccs","m64403e_230430_142929/147260103/ccs","m64403e_230430_142929/198252/ccs","m64403e_230430_142929/47777236/ccs","m64403e_230430_142929/53281662/ccs","m64403e_230430_142929/60099385/ccs","m64403e_230430_142929/64096340/ccs","m64403e_230430_142929/64356664/ccs","m64403e_230430_142929/65866578/ccs","m64403e_230430_142929/67569652/ccs","m64403e_230430_142929/72876178/ccs","m64403e_230430_142929/83886698/ccs","m64403e_230430_142929/8978946/ccs","m64403e_230430_142929/90047919/ccs","m64403e_230430_142929/9177283/ccs","m64403e_230430_142929/9765817/ccs","m64403e_230501_235831/104661083/ccs","m64403e_230501_235831/114950349/ccs","m64403e_230501_235831/133760000/ccs","m64403e_230501_235831/168493987/ccs","m64403e_230501_235831/17892932/ccs","m64403e_230501_235831/25232239/ccs","m64403e_230501_235831/28574000/ccs","m64403e_230501_235831/37749761/ccs","m64403e_230501_235831/75172147/ccs"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>101218154<\/th>\n      <th>101218155<\/th>\n      <th>101218156<\/th>\n      <th>101218157<\/th>\n      <th>101218158<\/th>\n      <th>101218159<\/th>\n      <th>101218160<\/th>\n      <th>101218161<\/th>\n      <th>101218162<\/th>\n      <th>101218163<\/th>\n      <th>101218164<\/th>\n      <th>101218165<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>If a read has at least one mCpG, we annotate this read as mCpG</p>
<pre class="r"><code>RID_cpg &lt;- data.frame(
  RID = rownames(rid_motifsite_combined),
  status = apply(rid_motifsite_combined, 1, function(x) {
    if (&quot;mCpG&quot; %in% x) &quot;mCpG&quot;
    else if (all(na.omit(x) == &quot;CpG&quot;)) &quot;CpG&quot;
    else NA
  }),
  row.names = NULL
)

DT::datatable(RID_cpg,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;Methylation info for each read&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-6e49b5d231d9a4691769" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6e49b5d231d9a4691769">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">Methylation info for each read<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39"],["m64403e_220914_215953/148177310/ccs","m64403e_220916_085351/110430727/ccs","m64403e_220916_085351/134087216/ccs","m64403e_220916_085351/162596995/ccs","m64403e_220916_085351/163709447/ccs","m64403e_220916_085351/23528864/ccs","m64403e_230429_051256/115279350/ccs","m64403e_230429_051256/161808431/ccs","m64403e_230429_051256/19532027/ccs","m64403e_230429_051256/65341726/ccs","m64403e_230429_051256/9373994/ccs","m64403e_230430_142929/117573517/ccs","m64403e_230430_142929/121570605/ccs","m64403e_230430_142929/136514381/ccs","m64403e_230430_142929/142476930/ccs","m64403e_230430_142929/147260103/ccs","m64403e_230430_142929/198252/ccs","m64403e_230430_142929/47777236/ccs","m64403e_230430_142929/53281662/ccs","m64403e_230430_142929/60099385/ccs","m64403e_230430_142929/64096340/ccs","m64403e_230430_142929/64356664/ccs","m64403e_230430_142929/65866578/ccs","m64403e_230430_142929/67569652/ccs","m64403e_230430_142929/72876178/ccs","m64403e_230430_142929/83886698/ccs","m64403e_230430_142929/8978946/ccs","m64403e_230430_142929/90047919/ccs","m64403e_230430_142929/9177283/ccs","m64403e_230430_142929/9765817/ccs","m64403e_230501_235831/104661083/ccs","m64403e_230501_235831/114950349/ccs","m64403e_230501_235831/133760000/ccs","m64403e_230501_235831/168493987/ccs","m64403e_230501_235831/17892932/ccs","m64403e_230501_235831/25232239/ccs","m64403e_230501_235831/28574000/ccs","m64403e_230501_235831/37749761/ccs","m64403e_230501_235831/75172147/ccs"],["CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>RID<\/th>\n      <th>status<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>This results in two groups of reads: those containing mCpG and those
without methylation. We then compare footprint frequencies between the
two groups.</p>
<p>We restrict the analysis to reads without nucleosome footprints,
since transcription factors cannot bind when the motif is occupied by a
nucleosome.</p>
<pre class="r"><code>fps &lt;- res$fiberHMM_fps_infire
fps_TF &lt;- fps[fps$class %in% c(&quot;&lt; 40bp&quot;, &quot;40-60bp&quot;),]
fps_gr &lt;- GRanges(fps_TF$chr, IRanges(fps_TF$start, fps_TF$end), strand=fps_TF$strand)
mcols(fps_gr) &lt;- fps_TF[, !(names(fps_TF) %in% c(&quot;chr&quot;,&quot;start&quot;,&quot;end&quot;,&quot;strand&quot;))]

hw &lt;- GRanges(region$chr, IRanges(start_motif1, end_motif1))
fps_gr &lt;- fps_gr[width(pintersect(fps_gr, hw)) &gt; 0]
rid_motif1_fp &lt;- as.character(fps_gr$RID)

fps &lt;- res$fiberHMM_fps
fps_nucl &lt;- fps[fps$size %in% c(&quot;&gt; 100bp&quot;, &quot;60-100bp&quot;),]
fps_gr_nucl &lt;- GRanges(fps_nucl$chr, IRanges(fps_nucl$fp_blockStarts, fps_nucl$fp_blockEnds))
mcols(fps_gr_nucl) &lt;- fps_nucl[, !(names(fps_nucl) %in% c(&quot;chr&quot;,&quot;start&quot;,&quot;end&quot;))]
fps_gr_nucl &lt;- fps_gr_nucl[width(pintersect(fps_gr_nucl, hw, ignore.strand = T)) &gt; 0]
rid_fps_nucl &lt;- as.character(fps_gr_nucl$RID)

# filter rid sets
rid_motif1_without_nucl &lt;- setdiff(rid_motif1, rid_fps_nucl)
RIDs_overlap_both &lt;- intersect(rid_motif1_without_nucl, RID_cpg$RID)

RIDs_access.df &lt;- data.frame(
  RID = RIDs_overlap_both,
  TF = RIDs_overlap_both %in% rid_motif1_fp,
  mCpG = RIDs_overlap_both %in% RID_cpg$RID[RID_cpg$status==&quot;mCpG&quot;]
)

RIDs_access.df$TF &lt;- factor(RIDs_access.df$TF, levels=c(FALSE, TRUE))
RIDs_access.df$mCpG &lt;- factor(RIDs_access.df$mCpG, levels=c(FALSE, TRUE))

print(RIDs_access.df)</code></pre>
<pre><code>                                   RID    TF  mCpG
1  m64403e_220914_215953/148177310/ccs  TRUE FALSE
2  m64403e_220916_085351/110430727/ccs  TRUE FALSE
3  m64403e_220916_085351/134087216/ccs  TRUE FALSE
4  m64403e_220916_085351/163709447/ccs  TRUE FALSE
5   m64403e_220916_085351/23528864/ccs FALSE FALSE
6  m64403e_230429_051256/115279350/ccs  TRUE FALSE
7  m64403e_230429_051256/161808431/ccs FALSE FALSE
8   m64403e_230429_051256/19532027/ccs FALSE FALSE
9   m64403e_230429_051256/65341726/ccs  TRUE FALSE
10   m64403e_230429_051256/9373994/ccs  TRUE FALSE
11 m64403e_230430_142929/136514381/ccs FALSE FALSE
12 m64403e_230430_142929/142476930/ccs FALSE FALSE
13 m64403e_230430_142929/147260103/ccs  TRUE FALSE
14    m64403e_230430_142929/198252/ccs  TRUE FALSE
15  m64403e_230430_142929/47777236/ccs  TRUE FALSE
16  m64403e_230430_142929/53281662/ccs FALSE FALSE
17  m64403e_230430_142929/60099385/ccs FALSE FALSE
18  m64403e_230430_142929/64096340/ccs  TRUE FALSE
19  m64403e_230430_142929/64356664/ccs FALSE FALSE
20  m64403e_230430_142929/72876178/ccs  TRUE FALSE
21  m64403e_230430_142929/83886698/ccs  TRUE FALSE
22   m64403e_230430_142929/8978946/ccs  TRUE FALSE
23  m64403e_230430_142929/90047919/ccs  TRUE FALSE
24   m64403e_230430_142929/9177283/ccs  TRUE FALSE
25   m64403e_230430_142929/9765817/ccs FALSE FALSE
26 m64403e_230501_235831/104661083/ccs FALSE FALSE
27 m64403e_230501_235831/114950349/ccs FALSE FALSE
28 m64403e_230501_235831/133760000/ccs FALSE FALSE
29 m64403e_230501_235831/168493987/ccs  TRUE FALSE
30  m64403e_230501_235831/17892932/ccs  TRUE FALSE
31  m64403e_230501_235831/25232239/ccs FALSE FALSE
32  m64403e_230501_235831/28574000/ccs  TRUE FALSE
33  m64403e_230501_235831/37749761/ccs  TRUE FALSE
34  m64403e_230501_235831/75172147/ccs FALSE FALSE</code></pre>
<pre class="r"><code>contingency_table &lt;- table(RIDs_access.df[,c(&quot;TF&quot;,&quot;mCpG&quot;)]) 
prop_col &lt;- round(prop.table(contingency_table, margin = 2) * 100,2)

print(contingency_table)</code></pre>
<pre><code>       mCpG
TF      FALSE TRUE
  FALSE    14    0
  TRUE     20    0</code></pre>
<pre class="r"><code>print(prop_col)</code></pre>
<pre><code>       mCpG
TF      FALSE TRUE
  FALSE 41.18     
  TRUE  58.82     </code></pre>
</div>
<div id="chr227134098-27135200" class="section level2">
<h2>chr2:27134098-27135200</h2>
<p>The third example is region chr2:27134098-27135200, focusing on the
motif chr2:27134667-27134678.</p>
<pre class="r"><code>library(data.table)
library(reshape2)
library(GenomicRanges)
library(ggplot2)
library(tidyverse)
library(gridExtra)
library(Biostrings)

source(&quot;/project/spott/kevinluo/Fiber_seq/fiberhub/code/process_fiberseq_data.R&quot;)
source(&quot;/project/spott/kevinluo/Fiber_seq/fiberhub/code/plots.R&quot;)

test_range_str &lt;- &quot;chr2:27134100-27135200&quot;
plot_name &lt;- &quot;NRF1_pairs_LCL_18508_chr2:27134100-27135200&quot;
result_dir &lt;- &quot;/project/xinhe/xsun/fiberseq/1.TFs/plot_region/results/NRF1_pairs/NRF1_pairs_LCL_18508_chr2:27134100-27135200/parsed&quot;

region &lt;- get_region(result_dir)
subtitle &lt;- sprintf(&quot;%s:%s-%s&quot;, region$chr, region$start, region$end)

# motif coordinates
start_motif1 &lt;- 27134667
end_motif1   &lt;- 27134678

region_plot &lt;- list(chr =&quot;chr10&quot;,
                    start = 27134500,
                    end = 27134800)

res &lt;- try(assemble_region_result(result_dir,
                       filter_fire_reads = FALSE,
                       cover_region_only = FALSE,
                       select_A_only = FALSE,
                       split_haplotype = FALSE,
                       highlight_window = data.frame(start=c(start_motif1), end=c(end_motif1)),
                       color_highlight_window = &quot;#44d6d8ff&quot;,
                       plot_name = plot_name,region = region_plot,
                       subtitle = subtitle)
  )</code></pre>
<pre><code>Assembling region result...
Load fiberHMM_res from result_dir 
Clustering reads...
43 reads.</code></pre>
<pre class="r"><code>gg &lt;- res$gg

print(cowplot::plot_grid(
  gg$pileup,
  gg$dimelo_reads,
  gg$fire_fdr,
  gg$fire_reads,
  gg$fiberHMM,
  ncol = 1,
  rel_heights = c(4,8,2,8,8),
  align = &quot;v&quot;,
  axis = &quot;b&quot;
))</code></pre>
<p><img src="figure/TF_co-acc_NRF1_pairs_cpg.Rmd/unnamed-chunk-13-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Next, we identify CpG positions within this motif. The CpG positions
are extracted from the corresponding .fa files.</p>
<pre class="r"><code>seq_region &lt;- readDNAStringSet(file.path(result_dir,&quot;/region.fa&quot;))
dna_seq &lt;- seq_region[[1]]
cpg_rel_pos &lt;- start(matchPattern(&quot;CG&quot;, dna_seq))
header &lt;- names(seq_region)       
parts &lt;- strsplit(header, &quot;[:-]&quot;)[[1]]
chrom &lt;- parts[1]
region_start &lt;- as.integer(parts[2])
cpg_df &lt;- data.frame(
  chrom = chrom,
  position = region_start + cpg_rel_pos - 1
)
cpg_df_inmotif &lt;- cpg_df[cpg_df$position &gt;= start_motif1 &amp; cpg_df$position &lt;= end_motif1,]

rid_motif1 &lt;- as.character(res$rids_df$RID[res$rids_df$start &lt;= end_motif1 &amp; res$rids_df$end &gt;= start_motif1])

rid_motifsite_mat &lt;- matrix(
  NA, 
  nrow = length(rid_motif1), 
  ncol = length(start_motif1:end_motif1),
  dimnames = list(rid_motif1, as.character(start_motif1:end_motif1))
)
rid_motifsite_methy &lt;- rid_motifsite_mat

# Mark CpG positions
rid_motifsite_mat[,colnames(rid_motifsite_mat) %in% as.character(cpg_df_inmotif$position)] &lt;- &quot;CpG&quot;

DT::datatable(rid_motifsite_mat,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;CpG positions in the motif for each read&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-3f92d051ff887de577da" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3f92d051ff887de577da">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">CpG positions in the motif for each read<\/caption>","data":[["m64403e_220914_215953/47121103/ccs","m64403e_220914_215953/53871552/ccs","m64403e_220914_215953/53871940/ccs","m64403e_220916_085351/145492349/ccs","m64403e_220916_085351/70256747/ccs","m64403e_220916_085351/88473960/ccs","m64403e_230429_051256/101778159/ccs","m64403e_230429_051256/112265925/ccs","m64403e_230429_051256/137955303/ccs","m64403e_230429_051256/160893445/ccs","m64403e_230429_051256/165349069/ccs","m64403e_230429_051256/168101956/ccs","m64403e_230429_051256/169280260/ccs","m64403e_230429_051256/4393235/ccs","m64403e_230429_051256/61211074/ccs","m64403e_230430_142929/104202644/ccs","m64403e_230430_142929/10813895/ccs","m64403e_230430_142929/113052109/ccs","m64403e_230430_142929/115607928/ccs","m64403e_230430_142929/124125520/ccs","m64403e_230430_142929/145425127/ccs","m64403e_230430_142929/151847140/ccs","m64403e_230430_142929/154206806/ccs","m64403e_230430_142929/173213213/ccs","m64403e_230430_142929/174983343/ccs","m64403e_230430_142929/31065866/ccs","m64403e_230430_142929/36637100/ccs","m64403e_230430_142929/45088816/ccs","m64403e_230430_142929/45877122/ccs","m64403e_230430_142929/93585770/ccs","m64403e_230501_235831/114819356/ccs","m64403e_230501_235831/124192175/ccs","m64403e_230501_235831/150997602/ccs","m64403e_230501_235831/152701474/ccs","m64403e_230501_235831/41747421/ccs","m64403e_230501_235831/4260373/ccs","m64403e_230501_235831/57081924/ccs","m64403e_230501_235831/66127631/ccs","m64403e_230501_235831/94833454/ccs","m64403e_230501_235831/95486273/ccs"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>27134667<\/th>\n      <th>27134668<\/th>\n      <th>27134669<\/th>\n      <th>27134670<\/th>\n      <th>27134671<\/th>\n      <th>27134672<\/th>\n      <th>27134673<\/th>\n      <th>27134674<\/th>\n      <th>27134675<\/th>\n      <th>27134676<\/th>\n      <th>27134677<\/th>\n      <th>27134678<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>We then retrieve methylation information from res$read.</p>
<pre class="r"><code># Fill methylation
reads_cpg &lt;- res$reads[res$reads$base == &quot;CG&quot;,]
reads_cpg$RID &lt;- as.character(reads_cpg$RID)

idx &lt;- which(reads_cpg$RID %in% rownames(rid_motifsite_methy) &amp;
               reads_cpg$ref_position %in% colnames(rid_motifsite_methy))

for (j in idx) {
  rid_motifsite_methy[reads_cpg$RID[j], as.character(reads_cpg$ref_position[j])] &lt;- reads_cpg$mod_qual[j]
}

DT::datatable(rid_motifsite_methy,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;Methylation quality score for each read&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-b11be92bafaf5007f73e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b11be92bafaf5007f73e">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">Methylation quality score for each read<\/caption>","data":[["m64403e_220914_215953/47121103/ccs","m64403e_220914_215953/53871552/ccs","m64403e_220914_215953/53871940/ccs","m64403e_220916_085351/145492349/ccs","m64403e_220916_085351/70256747/ccs","m64403e_220916_085351/88473960/ccs","m64403e_230429_051256/101778159/ccs","m64403e_230429_051256/112265925/ccs","m64403e_230429_051256/137955303/ccs","m64403e_230429_051256/160893445/ccs","m64403e_230429_051256/165349069/ccs","m64403e_230429_051256/168101956/ccs","m64403e_230429_051256/169280260/ccs","m64403e_230429_051256/4393235/ccs","m64403e_230429_051256/61211074/ccs","m64403e_230430_142929/104202644/ccs","m64403e_230430_142929/10813895/ccs","m64403e_230430_142929/113052109/ccs","m64403e_230430_142929/115607928/ccs","m64403e_230430_142929/124125520/ccs","m64403e_230430_142929/145425127/ccs","m64403e_230430_142929/151847140/ccs","m64403e_230430_142929/154206806/ccs","m64403e_230430_142929/173213213/ccs","m64403e_230430_142929/174983343/ccs","m64403e_230430_142929/31065866/ccs","m64403e_230430_142929/36637100/ccs","m64403e_230430_142929/45088816/ccs","m64403e_230430_142929/45877122/ccs","m64403e_230430_142929/93585770/ccs","m64403e_230501_235831/114819356/ccs","m64403e_230501_235831/124192175/ccs","m64403e_230501_235831/150997602/ccs","m64403e_230501_235831/152701474/ccs","m64403e_230501_235831/41747421/ccs","m64403e_230501_235831/4260373/ccs","m64403e_230501_235831/57081924/ccs","m64403e_230501_235831/66127631/ccs","m64403e_230501_235831/94833454/ccs","m64403e_230501_235831/95486273/ccs"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,0.6738281,null,0.7792969,null,null,null,null,null,null,null,null,0.8378906,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>27134667<\/th>\n      <th>27134668<\/th>\n      <th>27134669<\/th>\n      <th>27134670<\/th>\n      <th>27134671<\/th>\n      <th>27134672<\/th>\n      <th>27134673<\/th>\n      <th>27134674<\/th>\n      <th>27134675<\/th>\n      <th>27134676<\/th>\n      <th>27134677<\/th>\n      <th>27134678<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>stopifnot(identical(dimnames(rid_motifsite_methy), dimnames(rid_motifsite_mat)))</code></pre>
<p>By combining the CpG position matrix with the methylation quality
matrix, we annotate methylated sites as mCpG. A read is classified as
mCpG if it contains at least one methylated CpG.</p>
<pre class="r"><code># Combine CpG &amp; methylation
rid_motifsite_combined &lt;- ifelse(
  !is.na(rid_motifsite_methy) &amp; !is.na(rid_motifsite_mat), 
  &quot;mCpG&quot;,
  ifelse(!is.na(rid_motifsite_mat), &quot;CpG&quot;, NA)
)

DT::datatable(rid_motifsite_combined,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;Methylation annotation for each read&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-bc27f7549192058b9f6a" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-bc27f7549192058b9f6a">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">Methylation annotation for each read<\/caption>","data":[["m64403e_220914_215953/47121103/ccs","m64403e_220914_215953/53871552/ccs","m64403e_220914_215953/53871940/ccs","m64403e_220916_085351/145492349/ccs","m64403e_220916_085351/70256747/ccs","m64403e_220916_085351/88473960/ccs","m64403e_230429_051256/101778159/ccs","m64403e_230429_051256/112265925/ccs","m64403e_230429_051256/137955303/ccs","m64403e_230429_051256/160893445/ccs","m64403e_230429_051256/165349069/ccs","m64403e_230429_051256/168101956/ccs","m64403e_230429_051256/169280260/ccs","m64403e_230429_051256/4393235/ccs","m64403e_230429_051256/61211074/ccs","m64403e_230430_142929/104202644/ccs","m64403e_230430_142929/10813895/ccs","m64403e_230430_142929/113052109/ccs","m64403e_230430_142929/115607928/ccs","m64403e_230430_142929/124125520/ccs","m64403e_230430_142929/145425127/ccs","m64403e_230430_142929/151847140/ccs","m64403e_230430_142929/154206806/ccs","m64403e_230430_142929/173213213/ccs","m64403e_230430_142929/174983343/ccs","m64403e_230430_142929/31065866/ccs","m64403e_230430_142929/36637100/ccs","m64403e_230430_142929/45088816/ccs","m64403e_230430_142929/45877122/ccs","m64403e_230430_142929/93585770/ccs","m64403e_230501_235831/114819356/ccs","m64403e_230501_235831/124192175/ccs","m64403e_230501_235831/150997602/ccs","m64403e_230501_235831/152701474/ccs","m64403e_230501_235831/41747421/ccs","m64403e_230501_235831/4260373/ccs","m64403e_230501_235831/57081924/ccs","m64403e_230501_235831/66127631/ccs","m64403e_230501_235831/94833454/ccs","m64403e_230501_235831/95486273/ccs"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","mCpG","CpG","mCpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","mCpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>27134667<\/th>\n      <th>27134668<\/th>\n      <th>27134669<\/th>\n      <th>27134670<\/th>\n      <th>27134671<\/th>\n      <th>27134672<\/th>\n      <th>27134673<\/th>\n      <th>27134674<\/th>\n      <th>27134675<\/th>\n      <th>27134676<\/th>\n      <th>27134677<\/th>\n      <th>27134678<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>If a read has at least one mCpG, we annotate this read as mCpG</p>
<pre class="r"><code>RID_cpg &lt;- data.frame(
  RID = rownames(rid_motifsite_combined),
  status = apply(rid_motifsite_combined, 1, function(x) {
    if (&quot;mCpG&quot; %in% x) &quot;mCpG&quot;
    else if (all(na.omit(x) == &quot;CpG&quot;)) &quot;CpG&quot;
    else NA
  }),
  row.names = NULL
)

DT::datatable(RID_cpg,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;Methylation info for each read&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-8b2d970f83f6c5ce0219" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-8b2d970f83f6c5ce0219">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">Methylation info for each read<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40"],["m64403e_220914_215953/47121103/ccs","m64403e_220914_215953/53871552/ccs","m64403e_220914_215953/53871940/ccs","m64403e_220916_085351/145492349/ccs","m64403e_220916_085351/70256747/ccs","m64403e_220916_085351/88473960/ccs","m64403e_230429_051256/101778159/ccs","m64403e_230429_051256/112265925/ccs","m64403e_230429_051256/137955303/ccs","m64403e_230429_051256/160893445/ccs","m64403e_230429_051256/165349069/ccs","m64403e_230429_051256/168101956/ccs","m64403e_230429_051256/169280260/ccs","m64403e_230429_051256/4393235/ccs","m64403e_230429_051256/61211074/ccs","m64403e_230430_142929/104202644/ccs","m64403e_230430_142929/10813895/ccs","m64403e_230430_142929/113052109/ccs","m64403e_230430_142929/115607928/ccs","m64403e_230430_142929/124125520/ccs","m64403e_230430_142929/145425127/ccs","m64403e_230430_142929/151847140/ccs","m64403e_230430_142929/154206806/ccs","m64403e_230430_142929/173213213/ccs","m64403e_230430_142929/174983343/ccs","m64403e_230430_142929/31065866/ccs","m64403e_230430_142929/36637100/ccs","m64403e_230430_142929/45088816/ccs","m64403e_230430_142929/45877122/ccs","m64403e_230430_142929/93585770/ccs","m64403e_230501_235831/114819356/ccs","m64403e_230501_235831/124192175/ccs","m64403e_230501_235831/150997602/ccs","m64403e_230501_235831/152701474/ccs","m64403e_230501_235831/41747421/ccs","m64403e_230501_235831/4260373/ccs","m64403e_230501_235831/57081924/ccs","m64403e_230501_235831/66127631/ccs","m64403e_230501_235831/94833454/ccs","m64403e_230501_235831/95486273/ccs"],["CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","mCpG","CpG","mCpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","mCpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG","CpG"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>RID<\/th>\n      <th>status<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>This results in two groups of reads: those containing mCpG and those
without methylation. We then compare footprint frequencies between the
two groups.</p>
<p>We restrict the analysis to reads without nucleosome footprints,
since transcription factors cannot bind when the motif is occupied by a
nucleosome.</p>
<pre class="r"><code>fps &lt;- res$fiberHMM_fps_infire
fps_TF &lt;- fps[fps$class %in% c(&quot;&lt; 40bp&quot;, &quot;40-60bp&quot;),]
fps_gr &lt;- GRanges(fps_TF$chr, IRanges(fps_TF$start, fps_TF$end), strand=fps_TF$strand)
mcols(fps_gr) &lt;- fps_TF[, !(names(fps_TF) %in% c(&quot;chr&quot;,&quot;start&quot;,&quot;end&quot;,&quot;strand&quot;))]

hw &lt;- GRanges(region$chr, IRanges(start_motif1, end_motif1))
fps_gr &lt;- fps_gr[width(pintersect(fps_gr, hw)) &gt; 0]
rid_motif1_fp &lt;- as.character(fps_gr$RID)

fps &lt;- res$fiberHMM_fps
fps_nucl &lt;- fps[fps$size %in% c(&quot;&gt; 100bp&quot;, &quot;60-100bp&quot;),]
fps_gr_nucl &lt;- GRanges(fps_nucl$chr, IRanges(fps_nucl$fp_blockStarts, fps_nucl$fp_blockEnds))
mcols(fps_gr_nucl) &lt;- fps_nucl[, !(names(fps_nucl) %in% c(&quot;chr&quot;,&quot;start&quot;,&quot;end&quot;))]
fps_gr_nucl &lt;- fps_gr_nucl[width(pintersect(fps_gr_nucl, hw, ignore.strand = T)) &gt; 0]
rid_fps_nucl &lt;- as.character(fps_gr_nucl$RID)

# filter rid sets
rid_motif1_without_nucl &lt;- setdiff(rid_motif1, rid_fps_nucl)
RIDs_overlap_both &lt;- intersect(rid_motif1_without_nucl, RID_cpg$RID)

RIDs_access.df &lt;- data.frame(
  RID = RIDs_overlap_both,
  TF = RIDs_overlap_both %in% rid_motif1_fp,
  mCpG = RIDs_overlap_both %in% RID_cpg$RID[RID_cpg$status==&quot;mCpG&quot;]
)

RIDs_access.df$TF &lt;- factor(RIDs_access.df$TF, levels=c(FALSE, TRUE))
RIDs_access.df$mCpG &lt;- factor(RIDs_access.df$mCpG, levels=c(FALSE, TRUE))

print(RIDs_access.df)</code></pre>
<pre><code>                                   RID    TF  mCpG
1   m64403e_220914_215953/47121103/ccs  TRUE FALSE
2   m64403e_220914_215953/53871940/ccs  TRUE FALSE
3  m64403e_220916_085351/145492349/ccs  TRUE FALSE
4   m64403e_220916_085351/70256747/ccs  TRUE FALSE
5   m64403e_220916_085351/88473960/ccs  TRUE FALSE
6  m64403e_230429_051256/101778159/ccs  TRUE FALSE
7  m64403e_230429_051256/112265925/ccs  TRUE FALSE
8  m64403e_230429_051256/137955303/ccs  TRUE FALSE
9  m64403e_230429_051256/165349069/ccs  TRUE FALSE
10 m64403e_230429_051256/169280260/ccs  TRUE FALSE
11   m64403e_230429_051256/4393235/ccs  TRUE  TRUE
12 m64403e_230430_142929/104202644/ccs  TRUE FALSE
13 m64403e_230430_142929/113052109/ccs FALSE FALSE
14 m64403e_230430_142929/115607928/ccs  TRUE FALSE
15 m64403e_230430_142929/124125520/ccs FALSE FALSE
16 m64403e_230430_142929/151847140/ccs  TRUE FALSE
17 m64403e_230430_142929/154206806/ccs  TRUE  TRUE
18  m64403e_230430_142929/31065866/ccs  TRUE FALSE
19  m64403e_230430_142929/45088816/ccs FALSE FALSE
20  m64403e_230430_142929/45877122/ccs  TRUE FALSE
21  m64403e_230430_142929/93585770/ccs FALSE FALSE
22 m64403e_230501_235831/124192175/ccs  TRUE FALSE
23 m64403e_230501_235831/152701474/ccs  TRUE FALSE
24  m64403e_230501_235831/41747421/ccs  TRUE FALSE
25   m64403e_230501_235831/4260373/ccs  TRUE FALSE
26  m64403e_230501_235831/57081924/ccs  TRUE FALSE
27  m64403e_230501_235831/66127631/ccs  TRUE FALSE
28  m64403e_230501_235831/94833454/ccs  TRUE FALSE</code></pre>
<pre class="r"><code>contingency_table &lt;- table(RIDs_access.df[,c(&quot;TF&quot;,&quot;mCpG&quot;)]) 
prop_col &lt;- round(prop.table(contingency_table, margin = 2) * 100,2)

print(contingency_table)</code></pre>
<pre><code>       mCpG
TF      FALSE TRUE
  FALSE     4    0
  TRUE     22    2</code></pre>
<pre class="r"><code>print(prop_col)</code></pre>
<pre><code>       mCpG
TF       FALSE   TRUE
  FALSE  15.38   0.00
  TRUE   84.62 100.00</code></pre>
</div>
</div>
<div id="summary-of-all-motifs-analyzed" class="section level1">
<h1>Summary of all motifs analyzed</h1>
<pre class="r"><code>contingency_prop_col &lt;- readRDS(&quot;/project/xinhe/xsun/fiberseq/1.TFs/results/NRF1_pairs_cpg/contingency_prop_col.RDS&quot;)

mat &lt;- c()
names &lt;- c()
for (i in 1:length(contingency_prop_col)){
  
  table &lt;- contingency_prop_col[[i]]
  
  if(is.null(table) || (length(table) == 1 &amp;&amp; is.na(table))) next
  
  extract &lt;- contingency_prop_col[[i]][2,]
  names &lt;- c(names,names(contingency_prop_col[i]))
  mat &lt;- rbind(mat,extract)
  
}

mat &lt;- as.data.frame(mat)
rownames(mat) &lt;- NULL
colnames(mat) &lt;- c(&quot;methylated&quot;,&quot;not_methylated&quot;)
mat$motif &lt;- names


contingency_table &lt;- readRDS(&quot;/project/xinhe/xsun/fiberseq/1.TFs/results/NRF1_pairs_cpg/contingency_table.RDS&quot;)

mat_table &lt;- c()
mat_table_nfp &lt;- c()
names &lt;- c()
for (i in 1:length(contingency_prop_col)){
  
  table &lt;- contingency_table[[i]]
  
  if(is.null(table) || (length(table) == 1 &amp;&amp; is.na(table))) next
  
  extract &lt;- contingency_table[[i]][2,]
  names &lt;- c(names,names(contingency_table[i]))
  mat_table &lt;- rbind(mat_table,extract)
  mat_table_nfp &lt;- rbind(mat_table_nfp,contingency_table[[i]][1,])
  
}

mat_table &lt;- as.data.frame(mat_table)
rownames(mat_table) &lt;- NULL
colnames(mat_table) &lt;- c(&quot;methylated&quot;,&quot;not_methylated&quot;)
mat_table$motif &lt;- names

mat_table_nfp &lt;- as.data.frame(mat_table_nfp)
rownames(mat_table_nfp) &lt;- NULL
colnames(mat_table_nfp) &lt;- c(&quot;methylated&quot;,&quot;not_methylated&quot;)
mat_table_nfp$motif &lt;- names


tmp &lt;- merge(mat_table, mat_table_nfp, by = &quot;motif&quot;)
combine &lt;- merge(tmp, mat, by = &quot;motif&quot;)

colnames(combine) &lt;- c(&quot;motifsite&quot;,&quot;#of_fp_detected_in_methy_group&quot;,&quot;#of_fp_detected_in_non-methy_group&quot;,&quot;#of_no_fp_reads_in_methy_group&quot;,&quot;#of_no_fp_reads_in_non-methy_group&quot;,&quot;%of_fp_detected_in_methy_group&quot;,&quot;%of_fp_detected_in_non-methy_group&quot;)

DT::datatable(combine,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;footprint detected, %of_fp_detected_in_methy_group is calculated as: #of_fp_detected_in_methy_group/(#of_fp_detected_in_methy_group+#of_fp_detected_in_non-methy_group)\n&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-979009f5d5c312be05de" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-979009f5d5c312be05de">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">footprint detected, %of_fp_detected_in_methy_group is calculated as: #of_fp_detected_in_methy_group/(#of_fp_detected_in_methy_group+#of_fp_detected_in_non-methy_group)\n<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841","842","843","844","845","846","847","848","849","850","851","852","853","854","855","856","857","858","859","860","861","862","863","864","865","866","867","868","869","870","871","872","873","874","875","876","877","878","879","880","881","882","883","884","885","886","887","888","889","890","891","892","893","894","895","896","897","898","899","900","901","902","903","904","905","906","907","908","909","910","911","912","913","914","915","916","917","918","919","920","921","922","923","924","925","926","927","928","929","930","931","932","933","934","935","936","937","938","939","940","941","942","943","944","945","946","947","948","949","950","951","952","953","954","955","956","957","958","959","960","961","962","963","964","965","966","967","968","969","970","971","972","973","974","975","976","977","978","979","980","981","982","983","984","985","986","987","988","989","990","991","992","993","994","995","996","997","998","999","1000","1001","1002","1003","1004","1005","1006","1007","1008","1009","1010","1011","1012","1013","1014","1015","1016","1017","1018","1019","1020","1021","1022","1023","1024","1025","1026","1027","1028","1029","1030","1031","1032","1033","1034","1035","1036","1037","1038","1039","1040","1041","1042","1043","1044","1045","1046","1047","1048","1049","1050","1051","1052","1053","1054","1055","1056","1057","1058","1059","1060","1061","1062","1063","1064","1065","1066","1067","1068","1069","1070","1071","1072","1073","1074","1075","1076","1077","1078","1079","1080","1081","1082","1083","1084","1085","1086","1087","1088","1089","1090","1091","1092","1093","1094","1095","1096","1097","1098","1099","1100","1101","1102","1103","1104","1105","1106","1107","1108","1109","1110","1111","1112","1113","1114","1115","1116","1117","1118","1119","1120","1121","1122","1123","1124","1125","1126","1127","1128","1129","1130","1131","1132","1133","1134","1135","1136","1137","1138","1139","1140","1141","1142","1143","1144","1145","1146","1147","1148","1149","1150","1151","1152","1153","1154","1155","1156","1157","1158","1159","1160","1161","1162","1163","1164","1165","1166","1167","1168","1169","1170","1171","1172","1173","1174","1175","1176","1177","1178","1179","1180","1181","1182","1183","1184","1185","1186","1187","1188","1189","1190","1191","1192","1193","1194","1195","1196","1197","1198","1199","1200","1201","1202","1203","1204","1205","1206","1207","1208","1209","1210","1211","1212","1213","1214","1215","1216","1217","1218","1219","1220","1221","1222","1223","1224","1225","1226","1227","1228","1229","1230","1231","1232","1233","1234","1235","1236","1237","1238","1239","1240","1241","1242","1243","1244","1245","1246","1247","1248","1249","1250","1251","1252","1253","1254","1255","1256","1257","1258","1259","1260","1261","1262","1263","1264","1265","1266","1267","1268","1269","1270","1271","1272","1273","1274","1275","1276","1277","1278","1279","1280","1281","1282","1283","1284","1285","1286","1287","1288","1289","1290","1291","1292","1293","1294","1295","1296","1297","1298","1299","1300","1301","1302","1303","1304","1305","1306","1307","1308","1309","1310","1311","1312","1313","1314","1315","1316","1317","1318","1319","1320","1321","1322","1323","1324","1325","1326","1327","1328","1329","1330","1331","1332","1333","1334","1335","1336","1337","1338","1339","1340","1341","1342","1343","1344","1345","1346","1347","1348","1349","1350","1351","1352","1353","1354","1355","1356","1357","1358","1359","1360","1361","1362","1363","1364","1365","1366","1367","1368","1369","1370","1371","1372","1373","1374","1375","1376","1377","1378","1379","1380","1381","1382","1383","1384","1385","1386","1387","1388","1389","1390","1391","1392","1393","1394","1395","1396","1397","1398"],["site10092","site10093","site10094","site10095","site10096","site10102","site10152","site10167","site1021","site10224","site10266","site10267","site10268","site10296","site10297","site103","site10314","site1038","site1039","site104","site10439","site10440","site105","site10504","site10505","site10506","site10591","site106","site10626","site10627","site10679","site10681","site10756","site10757","site10758","site10759","site10770","site10771","site10772","site10995","site11176","site11177","site11252","site11253","site11262","site11263","site11347","site1138","site11381","site11382","site1139","site11488","site11588","site11603","site11604","site11605","site11606","site11607","site11608","site11609","site11611","site11765","site11786","site11811","site11812","site11813","site11814","site11815","site1182","site1183","site11834","site11835","site11840","site11841","site11859","site11860","site11924","site11925","site11938","site11939","site12012","site12013","site12014","site12015","site12016","site12017","site12018","site12028","site12029","site12030","site12095","site12096","site12111","site12112","site12113","site12119","site12211","site12212","site12370","site12372","site12385","site12391","site12392","site12393","site12444","site12471","site126","site12600","site12601","site12613","site12629","site12670","site12671","site127","site12706","site12712","site12713","site12714","site12720","site12721","site12722","site12728","site12729","site12730","site12798","site12799","site128","site12800","site12805","site12818","site12819","site12820","site12821","site12834","site129","site12914","site13012","site13029","site13030","site13060","site13061","site13117","site13118","site13190","site13191","site13248","site13305","site13456","site13457","site13473","site13474","site13544","site13545","site13601","site13602","site13603","site13718","site13798","site13799","site13800","site13801","site13802","site13863","site13864","site13865","site13866","site13867","site14007","site14008","site14011","site14012","site14116","site14117","site14127","site14128","site14227","site14255","site14256","site14257","site14258","site14410","site14411","site14511","site14512","site14513","site14583","site14597","site14598","site14609","site14610","site14654","site14655","site14656","site14701","site14702","site14829","site14830","site14982","site14983","site14984","site14985","site14986","site15201","site1527","site1528","site15300","site15301","site15442","site15490","site15512","site15536","site15537","site15622","site15680","site15681","site15682","site15683","site15761","site15762","site15809","site15810","site15811","site15824","site15825","site15826","site15827","site15919","site16021","site16045","site16046","site16064","site16065","site16108","site16109","site16118","site16120","site16121","site16122","site16123","site16150","site16151","site16188","site16189","site16297","site163","site1630","site16305","site16306","site1631","site164","site16507","site16508","site16509","site16510","site16514","site16689","site16690","site16727","site16747","site16748","site1676","site16777","site16790","site16791","site16800","site16801","site16802","site16836","site16880","site16881","site16970","site16971","site17077","site17121","site17203","site17204","site17246","site17247","site17250","site17251","site17252","site17253","site17438","site17439","site17440","site17442","site17443","site17444","site17549","site17613","site17614","site17615","site17616","site17617","site17636","site17637","site17638","site17639","site17640","site17641","site17642","site177","site178","site17860","site17863","site17864","site17877","site17900","site17901","site17902","site17903","site17904","site17905","site1795","site1796","site1797","site17998","site18023","site18024","site18025","site18116","site18117","site18118","site18119","site18334","site18393","site18394","site18395","site18397","site18398","site18411","site18427","site18428","site18429","site18430","site18470","site18471","site18477","site18487","site18488","site18494","site18495","site18532","site18533","site18534","site18545","site18546","site18554","site18555","site18556","site18557","site18560","site18561","site18562","site18563","site18586","site18591","site18592","site18613","site18614","site18623","site18650","site18651","site18669","site18670","site18671","site18756","site18757","site18791","site18793","site18794","site18815","site18835","site1885","site18853","site18854","site18965","site18992","site19022","site19023","site19112","site19151","site1919","site1925","site19330","site19331","site1952","site19566","site19567","site19586","site19587","site19615","site19616","site1966","site19667","site19668","site19707","site19860","site19897","site19906","site19907","site19908","site19909","site19951","site19956","site19957","site19961","site20085","site20086","site20087","site20135","site20139","site20140","site20209","site20210","site20222","site20223","site2026","site2027","site2028","site20397","site20398","site20399","site20400","site20401","site20402","site20423","site20424","site20425","site20433","site20434","site20447","site20448","site20456","site20466","site20467","site20468","site20469","site20473","site20474","site20491","site20492","site20516","site20517","site20522","site20523","site20631","site20632","site20633","site20717","site20718","site20732","site20733","site20734","site20735","site2084","site2085","site20876","site20877","site20912","site20913","site20926","site20927","site20928","site20929","site20930","site20961","site20962","site20981","site20982","site21139","site21140","site21223","site21224","site21225","site21226","site21232","site21316","site21317","site21483","site21484","site21579","site21580","site21590","site21591","site21592","site21593","site21594","site21595","site21672","site21673","site21674","site21677","site21678","site21679","site21680","site21772","site21773","site21774","site21775","site22045","site22046","site22076","site22077","site2215","site22190","site22191","site22204","site22205","site22210","site2236","site22550","site22554","site22556","site22557","site22668","site22690","site22691","site22692","site22787","site2282","site2283","site2284","site23008","site23009","site23010","site23089","site23106","site23107","site23112","site23213","site23214","site23236","site23237","site23243","site23274","site23275","site23330","site23331","site23332","site23334","site23335","site23465","site23466","site23467","site23468","site23472","site23473","site23518","site2358","site23620","site23621","site23800","site23801","site23802","site23803","site23932","site23933","site23974","site23975","site23976","site23977","site23989","site23990","site23991","site23992","site23995","site23996","site23999","site24000","site24002","site2402","site24032","site24033","site24047","site24068","site24069","site24070","site24071","site24086","site24089","site24090","site24098","site24099","site24100","site24101","site24102","site24139","site24193","site24229","site24324","site24325","site24326","site24327","site24333","site24334","site24374","site24384","site24385","site24398","site24399","site24405","site24410","site24417","site24418","site24441","site24442","site24601","site24604","site24605","site24722","site24791","site24792","site24804","site24805","site24827","site24844","site24852","site24876","site24877","site24911","site24912","site25046","site25047","site25074","site25075","site25132","site25133","site25151","site25172","site25173","site25174","site25201","site25202","site25218","site25219","site25262","site25263","site25278","site25279","site25293","site25294","site25295","site25296","site25302","site25303","site25329","site25330","site25331","site25332","site25333","site25334","site25341","site25357","site25382","site25408","site25409","site25410","site25411","site25445","site25446","site25447","site25448","site2550","site25533","site25534","site25536","site25537","site25543","site25544","site25545","site25547","site25548","site25588","site25592","site25593","site25747","site25748","site25749","site25750","site25925","site25926","site25931","site25932","site25933","site25934","site25935","site25936","site25937","site25938","site26037","site26082","site26083","site26090","site26091","site26120","site26121","site26136","site26137","site26162","site26172","site26197","site26200","site26201","site26202","site26210","site26248","site26249","site26250","site26251","site26252","site26253","site26262","site26263","site26281","site26351","site26352","site26411","site26412","site26470","site26480","site2649","site2650","site26517","site26519","site26529","site26719","site26796","site26797","site26811","site26812","site26847","site26848","site26849","site26850","site26858","site26903","site26904","site26919","site2692","site2693","site2694","site2695","site2696","site26990","site27000","site2714","site2715","site27218","site27257","site27286","site2731","site2739","site274","site2740","site27418","site27419","site275","site27554","site27555","site27556","site27566","site27567","site27597","site27598","site276","site277","site27740","site27899","site27900","site27901","site27909","site27961","site27962","site27976","site27977","site28031","site28032","site28064","site28065","site28069","site28070","site28071","site28121","site28134","site2816","site2817","site28172","site28173","site2818","site2819","site28220","site28221","site28222","site28223","site28224","site28225","site28236","site28271","site28272","site28327","site28328","site28329","site28330","site28331","site28332","site28333","site28334","site28345","site28352","site28353","site28354","site28355","site28361","site28362","site28363","site28364","site28365","site28370","site28371","site28372","site28373","site28374","site28375","site28376","site28377","site28378","site28379","site28380","site28381","site28445","site28446","site28447","site28448","site2846","site2847","site28470","site28471","site28521","site28556","site28557","site28558","site28580","site28581","site28589","site28590","site28591","site28709","site28710","site28757","site28758","site28776","site28777","site28778","site28809","site28816","site28822","site28823","site28834","site28835","site28836","site28837","site28867","site28868","site28871","site28893","site28894","site28895","site28896","site28897","site28898","site28902","site28903","site28915","site28916","site28917","site28918","site28923","site28924","site28925","site29024","site29068","site29072","site29094","site29095","site29099","site29100","site29101","site29102","site29103","site29141","site29291","site29292","site29293","site29296","site29297","site29298","site29299","site29300","site29301","site29315","site29316","site29317","site29318","site29328","site29329","site29339","site29340","site29344","site29345","site29350","site29352","site29434","site29435","site29436","site29459","site29466","site29467","site29468","site29469","site29474","site29547","site29548","site29549","site29550","site29551","site29552","site29553","site29554","site29582","site29583","site29603","site29604","site29609","site29610","site29611","site29612","site29613","site2965","site29655","site2966","site2967","site29693","site29694","site29695","site29729","site29730","site29731","site29732","site29782","site29783","site29797","site29799","site29800","site29803","site29893","site29894","site29895","site29900","site29935","site29936","site29939","site29940","site29941","site29943","site29968","site29969","site29978","site29988","site29989","site29990","site29991","site30004","site30005","site30006","site30007","site30008","site30009","site30025","site30026","site30087","site30111","site30112","site3014","site3015","site3016","site3017","site3018","site3019","site3020","site30246","site30247","site30434","site30435","site30534","site30535","site30544","site30545","site30546","site30547","site30556","site30557","site30558","site30559","site30595","site30596","site30621","site30622","site30644","site30645","site30646","site30647","site30652","site30653","site30654","site30695","site30696","site30770","site30771","site30799","site30810","site30811","site30812","site30813","site30814","site30815","site30816","site30817","site30927","site30928","site30979","site31008","site31009","site31013","site31014","site31065","site31066","site31107","site31108","site31155","site31156","site31176","site31189","site31190","site31215","site31216","site31217","site3135","site31585","site31586","site31605","site31606","site31607","site31667","site31668","site31669","site31699","site31700","site31701","site31711","site3174","site3175","site31750","site31751","site31760","site31807","site31808","site31809","site31810","site31856","site31857","site31858","site31859","site31867","site31912","site31913","site31915","site31916","site31917","site31918","site31919","site31920","site32116","site32135","site32187","site32202","site32203","site32204","site32205","site32244","site32245","site32246","site32247","site32248","site32249","site32250","site32251","site32256","site32257","site32258","site32260","site32273","site32274","site32373","site32374","site32375","site32393","site32466","site32467","site32468","site32469","site32474","site32512","site32513","site32539","site32549","site32550","site32559","site32560","site32591","site32592","site32630","site32670","site32671","site32672","site32673","site32674","site3273","site3281","site32846","site32847","site32848","site3293","site3294","site3323","site3324","site3325","site3332","site3333","site3357","site3358","site3359","site3360","site3366","site3367","site3368","site3387","site3388","site3616","site3617","site3618","site3697","site3701","site3704","site3711","site3712","site3713","site3773","site3841","site3842","site3953","site3954","site3965","site3988","site3989","site4039","site4040","site4084","site4096","site4106","site4107","site4108","site4109","site4110","site4111","site4112","site4113","site4124","site4189","site4190","site4259","site4260","site4646","site4647","site4648","site4649","site4669","site4684","site4685","site473","site474","site475","site4794","site4795","site480","site481","site4811","site4812","site4813","site4814","site4816","site4817","site482","site483","site489","site490","site503","site504","site507","site508","site5082","site509","site510","site512","site5150","site5165","site5166","site5376","site5414","site5415","site5436","site5437","site5444","site5455","site5513","site5514","site5515","site5516","site5517","site5518","site5519","site5610","site5671","site5677","site5678","site5719","site5720","site5738","site5739","site5784","site5785","site5788","site5789","site5790","site5849","site5850","site5851","site5852","site5867","site5868","site601","site6066","site6149","site6172","site6179","site6180","site6195","site6196","site6236","site625","site6253","site6254","site6255","site6256","site6257","site6258","site626","site6267","site6361","site6365","site6383","site6384","site6385","site6402","site6423","site6506","site6520","site6521","site6522","site6523","site6570","site6571","site6605","site6606","site6857","site6858","site6859","site6860","site6883","site6884","site6885","site6886","site6898","site6899","site6932","site6933","site6934","site6935","site7009","site7010","site7011","site7014","site7015","site7030","site7031","site7065","site7066","site7067","site7068","site709","site710","site7110","site713","site714","site716","site717","site7210","site7225","site7226","site7352","site7353","site7434","site747","site748","site7530","site7531","site7560","site765","site7652","site7653","site766","site7711","site780","site781","site7857","site787","site7940","site7944","site7945","site7992","site7993","site8585","site8586","site8587","site8588","site8589","site859","site8590","site860","site8602","site8603","site8604","site861","site862","site8662","site8673","site8747","site8748","site9049","site9050","site9051","site9052","site9055","site9056","site9137","site9175","site9176","site9230","site9233","site925","site9255","site9351","site9365","site9366","site9415","site9416","site9509","site9532","site9533","site9562","site9563","site9590","site9591","site9622","site9657","site9695","site9815","site9816","site9845","site9893","site9894","site9895","site9896","site9922","site9966","site9967","site9968","site9995"],[1,1,11,11,13,13,14,4,7,18,18,18,18,9,8,6,16,15,15,7,7,7,9,1,0,0,14,9,23,23,15,2,19,18,18,18,2,6,6,1,1,0,13,13,12,13,0,26,13,13,26,1,3,3,3,1,1,1,2,2,1,19,5,0,0,2,2,2,23,23,20,21,6,13,18,18,7,6,1,1,2,2,2,2,2,16,16,6,7,7,18,18,13,15,14,1,11,11,6,1,0,6,6,4,10,16,16,6,6,15,14,24,24,16,0,11,10,19,64,63,102,0,0,3,2,3,0,1,11,16,15,15,15,6,0,7,6,9,9,15,15,12,12,5,5,18,3,2,2,0,0,16,17,13,14,4,4,16,16,1,6,6,0,2,2,0,0,0,0,16,16,30,30,4,4,16,12,12,14,14,3,3,3,6,7,0,6,6,0,0,6,10,7,17,17,0,0,8,8,8,10,10,0,6,6,11,11,5,4,1,4,4,5,19,19,19,19,13,13,3,3,8,22,22,21,22,10,26,11,1,11,11,12,12,3,2,26,2,2,19,19,8,8,12,19,26,10,10,26,19,15,15,12,12,3,1,1,10,0,0,1,0,3,3,17,20,20,22,23,23,5,12,24,10,1,1,13,13,4,4,4,4,6,6,17,22,22,21,0,6,6,6,2,2,14,14,16,16,11,4,3,0,0,1,16,16,3,11,11,2,2,5,5,18,21,21,17,0,2,2,12,11,14,14,1,4,4,3,2,1,6,3,3,3,3,1,17,3,19,19,8,7,8,20,20,4,4,10,10,13,13,3,3,12,12,19,24,21,2,2,13,20,20,3,3,6,18,19,20,0,0,0,0,22,19,2,1,2,6,6,0,7,16,15,20,20,4,11,11,10,10,6,6,9,7,7,1,12,16,9,9,11,11,10,0,0,12,13,13,9,6,2,2,11,11,11,11,17,29,29,0,0,0,0,0,0,12,12,9,18,18,1,1,32,0,0,2,2,3,3,20,20,6,7,14,14,8,8,2,0,0,0,13,5,5,16,16,0,0,5,5,23,24,0,4,4,19,19,20,20,15,15,15,15,27,27,16,0,2,17,17,1,1,3,4,4,4,4,12,0,16,16,3,3,3,3,18,18,10,5,20,20,15,15,0,4,4,19,18,1,21,18,17,16,16,1,5,5,4,1,2,16,16,6,6,8,7,2,2,0,3,1,9,9,0,11,11,2,7,7,5,2,9,9,9,9,10,10,15,0,3,3,17,17,17,17,0,1,18,16,11,11,20,20,5,8,12,12,2,1,14,26,0,0,0,30,30,29,29,6,1,1,6,6,7,6,5,21,5,11,5,10,10,26,16,16,1,5,5,11,11,11,2,0,0,2,2,21,15,15,13,9,9,24,25,0,11,22,28,27,22,22,6,7,0,0,24,25,8,2,3,2,10,10,12,12,3,3,18,18,4,4,19,19,12,13,20,26,19,16,22,9,1,18,0,23,23,8,8,4,4,13,13,9,13,13,16,16,9,9,0,3,3,10,1,1,10,10,10,8,14,14,2,2,8,7,4,10,4,24,0,1,1,3,3,14,14,0,0,4,6,8,15,15,0,19,2,1,1,1,1,1,4,4,6,11,11,28,28,2,0,8,8,14,17,3,4,2,2,28,28,1,1,2,1,13,12,12,1,1,5,5,9,9,4,0,7,7,12,2,20,1,1,8,1,2,1,8,19,15,15,20,20,23,23,6,6,1,1,1,0,0,0,0,13,13,7,7,5,5,3,9,10,22,0,5,4,5,3,4,4,0,4,17,17,13,13,2,1,1,8,8,8,8,8,9,21,21,25,2,2,9,9,28,28,25,25,9,10,10,14,11,12,12,0,16,16,17,17,9,23,23,4,4,5,5,18,17,5,1,1,1,9,9,12,17,17,9,9,20,20,13,13,13,12,25,9,10,17,17,17,17,1,6,0,11,11,5,5,13,13,16,16,5,5,7,5,5,13,13,9,9,3,8,8,1,1,0,19,19,8,1,5,5,8,8,0,0,0,0,5,5,9,9,7,7,2,2,23,23,4,0,3,22,22,9,26,27,25,25,18,8,8,18,13,17,17,19,19,0,0,2,2,2,2,1,1,1,11,2,13,13,19,19,18,10,10,10,16,8,8,1,2,2,7,6,6,7,1,0,0,5,1,1,11,2,2,8,8,9,13,13,0,0,2,2,9,10,12,12,7,4,4,16,16,26,14,22,19,15,1,1,9,9,6,6,13,12,21,21,5,5,5,5,11,11,16,16,0,19,19,3,21,21,0,18,18,19,19,23,2,2,2,2,2,2,2,2,18,18,4,2,2,13,13,1,1,6,6,2,1,18,0,0,1,8,8,7,5,5,10,10,18,0,13,13,0,1,1,12,0,0,8,7,1,5,5,5,7,28,28,20,20,15,21,21,16,16,1,1,23,23,2,1,2,13,13,11,11,14,14,9,9,8,8,8,8,3,5,5,1,0,0,1,1,0,1,1,0,0,0,27,16,16,3,1,1,9,9,5,5,0,13,13,12,18,18,0,20,16,19,19,24,24,0,0,3,2,2,3,1,1,1,24,24,20,11,25,8,14,15,3,9,1,21,22,6,9,4,4,1,1,3,16,16,26,28,19,21,6,6,20,20,20,20,4,4,7,21,21,0,0,15,15,17,0,8,11,11,5,5,6,2,0,3,3,15,16,9,10,23,29,3,3,16,16,0,0,0,0,2,2,2,4,13,0,0,26,15,15,30,30,1,1,2,2,2,2,2,2,2,12,0,16,16,1,1,18,19,17,17,20,18,18,1,1,1,1,25,25,19,5,19,2,2,2,20,20,20,12,36,36,34,34,30,30,12,11,19,17,0,0,0,9,7,4,17,17,20,20,21,21,13,13,4,4,5,5,23,23,24,24,26,26,22,21,20,20,23,8,8,7,7,7,7,23,23,7,7,24,25,20,16,17,16,16,18,9,9,17,17,1,15,15,12,12,6,14,5,5,14,1,5,7,6,16,3,11,11,5,19,13,13,11,11,18,31,18,32,26,26,8,18,18,15,3,25,25,20,21,21,21,5,5,12,21,21,1,6,2,17,18,5,5,24,24,2,10,11,6,18,6,2,2,15,13,7,6,2,19,19,19,18,10,14,13,13,1],[0,0,0,0,0,1,1,0,4,1,0,0,0,1,0,0,4,0,0,0,3,3,0,0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,2,0,0,2,1,0,0,0,1,0,0,0,0,0,2,0,0,0,0,0,0,0,0,1,0,1,1,0,0,3,3,0,0,0,0,0,0,0,0,0,2,1,1,2,2,3,0,0,0,2,2,0,0,0,0,0,0,0,0,4,1,1,1,1,1,1,4,0,1,1,1,5,5,21,0,0,1,0,0,0,0,4,0,1,1,1,0,0,0,1,0,0,1,1,0,0,0,0,2,1,2,2,0,0,2,2,0,0,1,0,1,1,1,0,0,2,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,1,1,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,2,2,0,2,0,0,0,1,2,2,2,2,1,1,0,0,0,3,3,4,3,0,5,0,0,1,1,0,0,0,0,3,0,0,0,0,0,0,2,1,3,0,0,3,1,1,1,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,3,6,6,1,0,3,0,0,0,0,0,0,0,0,0,0,0,1,3,3,1,0,0,0,0,0,0,1,1,2,2,1,0,0,0,0,0,3,3,0,0,0,0,0,0,0,2,0,0,3,0,0,0,3,4,1,1,0,0,0,1,0,0,1,0,0,0,0,0,2,1,1,1,2,2,0,2,2,0,0,1,1,0,0,0,0,1,1,0,1,0,0,0,0,2,2,1,1,0,1,1,1,0,0,0,0,1,2,0,0,0,0,0,1,3,2,2,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,1,0,0,2,0,0,4,0,0,0,0,0,0,0,2,1,1,0,0,0,0,0,0,2,2,1,0,0,0,0,3,0,0,0,0,0,0,2,2,0,0,1,1,1,1,0,0,0,1,0,1,1,2,2,0,0,0,0,1,0,0,1,1,1,1,0,0,2,2,0,0,1,1,1,1,0,8,8,1,1,1,0,0,0,0,1,0,2,2,0,0,0,0,1,1,0,0,2,2,1,1,0,0,0,2,2,0,0,1,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,2,4,1,1,2,2,4,1,0,0,1,0,1,1,0,0,0,2,2,4,4,1,0,0,1,1,0,0,1,1,0,1,0,0,0,4,2,2,0,1,1,1,1,1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,2,0,0,1,1,1,4,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,3,3,1,0,1,1,4,0,2,3,0,1,0,0,0,0,0,0,0,0,0,2,1,1,1,2,2,2,0,0,0,1,0,0,6,6,6,0,2,2,0,0,0,0,1,2,1,4,0,0,0,0,0,1,1,0,0,0,0,1,4,4,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,4,0,1,2,0,0,5,5,0,0,0,0,1,0,0,0,0,2,2,2,2,1,0,0,0,2,2,1,0,0,1,0,0,2,1,1,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,0,0,1,1,0,2,1,0,0,1,1,0,0,2,2,1,0,1,1,1,1,0,0,0,0,0,0,0,0,1,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,4,4,4,4,0,1,1,1,1,0,0,0,0,0,0,0,0,2,2,3,1,1,1,1,4,4,2,2,2,1,1,0,1,1,1,2,2,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,2,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,0,3,2,1,1,1,1,1,1,2,0,0,1,1,0,0,0,0,0,0,0,0,0,3,0,3,3,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,3,0,0,0,3,2,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,1,0,0,1,1,1,1,1,1,0,0,0,0,2,2,0,0,0,0,2,2,1,1,0,1,1,0,5,5,0,1,1,2,2,0,0,0,0,0,0,0,0,0,1,1,0,0,0,2,2,0,0,0,0,0,1,5,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,1,1,2,0,0,1,1,0,1,1,1,1,1,1,4,4,3,1,1,2,2,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,1,0,0,0,1,1,1,1,0,0,0,1,6,6,0,1,2,0,0,3,3,0,0,0,0,0,0,0,0,0,1,1,1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,4,4,1,2,2,2,0,0,3,1,1,1,1,1,1,0,0,0,2,2,0,0,1,1,1,0,1,1,1,0,0,0,0,1,0,0,1,1,0,0,1,0,0,0,5,5,0,0,0,0,0,0,0,1,0,0,0,0,1,1,2,2,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,1,0,0,2,4,4,0,0,1,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,1,1,0,3,3,1,1,1,1,0,0,0,0,0,0,2,2,4,4,1,1,3,3,1,1,1,0,0,1,1,0,0,3,3,1,1,1,1,0,2,1,2,1,1,1,1,2,2,0,1,1,2,2,0,0,3,3,0,0,1,2,0,3,0,0,0,0,2,0,0,3,3,2,2,2,1,1,1,1,2,2,0,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,1,0,0,0,4,4,0,0,0,0,2,0,0,0,1,0,1,2,0,0,0,0,0,2,2,4,4,0],[5,5,2,2,1,2,3,39,15,10,1,1,1,10,10,11,5,3,3,10,14,14,6,1,2,2,5,6,8,8,4,15,11,13,16,16,9,23,23,16,22,25,19,19,16,17,7,1,1,1,1,11,6,0,0,1,1,1,0,0,0,3,28,11,11,11,3,3,3,3,8,8,10,5,2,2,12,13,10,10,28,28,28,28,28,12,12,12,13,12,8,8,1,2,3,7,14,14,19,29,0,17,17,18,24,12,6,2,2,4,2,6,6,6,23,4,5,3,28,29,11,1,1,1,10,10,33,11,6,10,10,10,10,11,32,20,13,25,25,13,13,20,20,4,4,2,13,0,0,5,5,14,13,13,12,18,27,3,3,26,22,22,20,25,25,24,24,15,15,6,7,4,4,18,18,2,8,7,5,5,10,10,6,1,1,18,13,13,12,12,17,6,11,4,4,18,7,38,35,36,28,29,18,3,3,2,2,15,15,11,14,14,16,3,3,4,4,7,6,25,25,20,4,4,3,4,13,5,3,14,7,7,11,11,15,26,4,29,29,2,2,1,1,19,2,3,16,16,3,2,1,1,3,3,21,25,25,23,2,2,9,22,8,8,8,8,8,5,3,3,9,3,1,15,5,5,13,13,19,19,19,19,12,12,2,3,3,5,28,13,13,13,13,13,15,16,13,13,17,24,27,25,25,9,4,4,26,2,2,9,9,9,9,3,2,2,5,29,24,24,0,0,0,0,3,21,21,25,12,13,14,4,4,4,4,21,2,17,4,4,9,10,18,7,7,7,7,23,23,22,22,9,9,16,16,19,5,4,14,14,9,4,4,18,18,17,5,4,5,5,5,20,29,4,9,27,25,17,10,10,11,13,6,0,1,1,7,13,13,3,3,15,17,12,23,24,23,11,14,10,10,6,6,1,26,26,11,4,4,0,22,26,26,15,15,16,16,9,6,6,12,12,12,12,12,12,3,3,6,6,6,24,24,3,13,12,14,14,0,0,4,3,19,18,6,6,2,2,8,0,0,16,3,11,11,2,2,13,13,20,20,0,0,18,15,15,3,3,4,4,4,4,6,6,3,3,0,22,21,2,2,23,23,14,14,14,14,14,10,1,0,0,14,14,11,10,0,0,8,12,0,0,5,5,22,20,20,1,3,30,11,4,4,1,1,12,11,11,23,6,27,8,8,11,12,11,20,21,21,8,22,20,13,13,18,11,11,22,21,21,19,23,13,13,14,14,7,7,10,10,23,23,1,1,1,1,18,23,2,1,8,8,7,7,9,9,13,13,12,12,7,8,7,6,2,3,3,2,2,15,28,28,11,11,13,14,12,8,23,9,17,19,19,2,2,2,17,8,8,9,9,7,4,11,11,21,21,7,5,5,17,6,6,4,3,5,12,9,2,2,1,1,14,24,3,3,4,4,8,12,12,17,1,1,11,11,14,16,9,9,18,18,3,3,7,7,5,3,1,3,3,4,9,7,15,4,4,12,12,7,6,14,14,5,3,3,13,15,1,1,11,11,8,8,13,16,13,13,13,17,9,9,18,18,15,19,16,13,24,1,5,6,6,5,5,1,1,5,5,16,20,21,3,3,14,5,13,24,24,24,24,24,25,25,12,14,14,5,5,23,0,9,9,4,15,22,32,19,19,2,2,18,18,17,19,14,5,5,4,20,4,5,1,1,28,4,2,2,8,20,2,10,17,0,17,8,8,0,2,10,10,4,4,5,5,2,2,9,1,1,1,11,5,5,12,12,13,13,15,14,13,6,7,5,1,1,2,14,18,4,4,8,10,1,1,6,6,17,20,20,16,16,14,14,16,13,1,1,7,10,10,3,3,3,3,6,7,23,11,12,4,7,7,7,21,7,7,6,6,19,1,1,20,17,17,17,4,5,26,4,5,5,9,10,4,3,3,13,13,0,0,9,9,9,9,5,3,2,10,10,5,6,12,23,3,5,5,12,12,4,5,18,18,7,7,3,5,17,12,12,14,14,10,19,19,20,20,23,2,2,19,5,2,2,3,3,10,10,10,10,4,4,1,1,5,5,11,11,1,1,13,15,28,2,2,12,5,5,7,7,1,12,12,1,6,5,5,1,1,4,4,22,23,7,7,5,4,1,8,18,3,3,3,3,2,11,11,11,4,3,3,5,1,1,2,1,1,0,6,15,15,20,22,20,15,1,1,8,16,16,0,0,14,14,15,15,12,11,12,13,16,21,21,8,8,0,12,4,5,6,33,33,11,11,24,24,14,15,4,4,7,7,8,8,6,6,14,14,8,2,2,21,2,2,30,5,5,1,1,7,16,16,16,18,18,18,18,18,15,15,12,24,23,10,10,11,11,20,20,12,12,1,14,14,6,1,1,5,19,19,19,19,11,5,9,9,0,3,3,5,25,27,10,10,13,25,25,30,28,4,4,3,3,4,6,6,11,11,23,24,6,6,24,23,7,20,20,24,24,4,4,9,9,9,9,9,9,22,5,5,19,10,10,29,29,32,8,1,5,3,3,1,13,13,12,0,0,4,4,16,16,5,19,19,18,6,6,26,4,2,1,1,1,1,25,25,27,18,21,27,29,27,27,2,2,6,14,0,12,9,6,6,23,13,2,2,14,22,18,18,4,4,24,11,11,7,9,8,3,10,10,1,1,1,1,12,12,13,8,8,1,1,5,5,4,23,17,13,13,20,20,18,17,21,13,13,4,3,13,13,12,4,20,21,0,0,1,1,5,5,17,6,6,10,10,2,3,2,5,5,2,2,13,9,20,20,20,20,20,20,20,12,11,11,11,17,17,0,0,16,16,4,4,4,23,24,20,23,1,1,8,8,0,19,13,13,5,5,2,5,0,0,3,3,5,5,5,20,2,3,19,19,20,8,2,12,5,5,4,4,4,4,14,14,0,0,0,0,3,3,3,3,0,0,2,3,2,2,0,11,11,7,7,8,8,0,0,18,18,4,3,3,7,8,5,6,9,6,6,11,11,29,8,8,11,11,12,6,19,19,6,10,23,21,25,12,16,11,11,20,5,8,8,9,9,6,1,6,1,2,2,27,14,14,10,12,1,1,5,4,4,4,18,18,12,2,2,11,20,16,9,5,6,6,4,4,20,9,9,15,4,22,28,26,7,11,7,7,21,17,17,17,18,14,12,8,8,1],[5,5,0,0,0,0,0,7,1,3,0,0,0,0,0,0,4,2,2,0,5,5,0,0,0,0,0,0,4,4,0,6,1,1,0,0,0,0,0,1,0,2,1,1,3,2,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,0,1,0,0,0,3,3,0,0,1,1,1,1,1,0,0,2,1,2,0,0,0,1,1,1,0,0,1,1,0,1,1,2,2,0,1,0,0,0,0,0,0,1,1,0,0,0,1,1,2,0,0,0,2,2,2,3,1,0,0,0,0,0,1,0,2,0,0,1,1,0,0,0,0,1,3,1,1,1,1,2,2,0,0,3,1,0,0,1,1,1,6,1,1,1,1,2,2,0,0,1,1,3,3,0,0,0,0,0,2,2,1,2,2,3,0,0,0,0,0,1,0,0,0,3,3,9,12,12,13,12,1,0,0,0,0,1,3,0,2,2,4,1,1,0,0,1,2,0,0,0,1,1,2,1,1,2,1,4,0,0,1,1,1,7,2,0,0,0,0,1,1,1,0,1,0,0,1,0,0,0,0,0,3,0,0,1,1,1,0,2,6,6,1,0,0,1,0,0,0,0,1,1,1,1,0,0,1,1,1,1,2,1,0,0,0,0,4,0,0,0,1,1,1,1,0,0,4,5,2,3,3,1,0,0,0,0,0,2,2,1,1,0,0,0,2,0,1,1,0,0,0,0,0,0,0,0,3,3,1,0,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,1,1,0,0,2,1,1,0,3,0,1,5,0,1,1,1,4,4,3,0,0,0,0,1,1,0,0,3,1,4,2,1,1,0,0,0,0,0,0,2,1,1,1,0,0,0,2,0,0,1,1,1,1,5,0,0,2,2,2,2,2,2,0,0,1,0,0,3,3,0,3,4,1,1,0,0,2,2,2,2,0,0,1,1,1,0,0,4,0,1,1,0,0,1,1,1,1,0,0,0,1,1,0,0,0,0,0,0,1,1,1,1,0,1,2,0,0,2,2,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,0,1,0,0,3,3,6,0,0,1,1,1,1,1,3,0,0,1,2,2,1,1,1,1,1,1,1,1,0,1,1,0,1,3,1,1,1,1,1,0,3,3,1,1,0,0,0,0,1,1,1,5,3,3,0,0,0,0,11,4,0,1,0,0,0,0,8,8,1,1,0,1,0,0,2,2,0,0,0,0,0,0,2,2,2,2,0,0,2,0,1,0,4,0,0,0,0,0,4,1,1,1,1,2,0,0,0,2,2,1,0,0,2,0,0,1,1,0,3,1,0,0,0,0,7,0,0,0,0,0,1,1,0,2,0,0,4,4,8,6,1,1,5,5,0,0,0,0,0,0,0,1,0,0,3,1,0,0,0,2,2,0,0,1,1,2,0,0,2,1,0,0,2,3,1,7,6,4,0,0,0,3,0,0,5,5,5,2,6,2,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,1,0,0,1,2,2,2,2,5,5,1,0,0,0,0,0,0,0,0,0,1,1,3,1,1,0,0,0,0,0,2,2,1,1,1,3,0,0,0,0,0,0,0,0,6,1,1,0,2,0,2,2,1,0,1,0,0,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,3,4,1,1,0,0,0,1,1,0,0,0,0,3,0,0,0,1,1,1,0,0,1,1,3,3,1,0,0,0,0,0,0,2,2,1,1,1,0,1,2,1,0,0,0,0,8,1,1,2,2,2,1,1,2,5,1,1,0,0,0,1,2,2,1,1,0,1,1,2,2,0,0,0,0,0,0,0,1,0,0,0,2,2,1,5,0,0,0,0,0,1,0,1,1,2,2,0,0,3,0,0,0,0,4,2,2,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,3,2,0,0,0,0,1,3,0,6,6,0,0,0,0,0,0,0,1,1,2,0,0,1,0,0,1,1,5,5,0,3,5,3,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,2,2,0,3,3,3,1,1,1,1,1,2,2,0,4,5,1,1,1,1,0,0,1,1,0,0,0,1,0,0,1,3,3,1,1,1,2,0,0,0,3,3,1,5,3,0,1,1,6,6,1,1,0,0,1,1,1,0,0,1,1,8,7,0,0,10,0,1,2,2,2,2,0,0,0,0,1,1,1,1,0,0,0,2,0,0,2,2,1,0,1,1,0,0,0,0,0,3,0,0,1,1,11,11,0,1,1,3,1,1,2,0,0,0,0,0,0,3,3,2,2,0,1,1,3,3,0,0,1,3,0,3,0,0,0,0,10,1,1,0,2,1,1,1,0,3,1,1,4,2,0,0,1,1,0,0,0,0,6,6,6,1,1,0,0,0,0,0,2,1,2,2,0,0,0,0,0,7,7,1,1,0,0,2,0,1,0,0,0,0,0,0,0,2,1,1,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,0,0,0,0,0,0,0,0,0,0,0,1,0,4,1,1,1,0,0,0,0,4,4,1,1,1,0,0,0,0,0,0,0,0,0,0,0,3,3,2,1,1,2,1,1,1,1,0,0,0,0,1,1,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,2,2,2,2,1,1,2,2,0,0,0,1,1,0,0,0,0,0,0,0,5,2,2,0,0,0,2,1,1,2,1,0,0,3,0,2,0,0,0,0,0,0,0,0,1,0,1,0,1,1,0,1,1,0,0,2,2,0,0,0,0,2,2,2,1,1,0,2,3,0,0,1,1,0,0,2,1,0,1,0,3,0,1,0,0,0,0,0,0,0,0,0,0,4,0,0,1],[16.67,16.67,84.62,84.62,92.86,86.67,82.35,9.3,31.82,64.29,94.74,94.74,94.74,47.37,44.44,35.29,76.19,83.33,83.33,41.18,33.33,33.33,60,50,0,0,73.68,60,74.19,74.19,78.95,11.76,63.33,58.06,52.94,52.94,18.18,20.69,20.69,5.88,4.35,0,40.62,40.62,42.86,43.33,0,96.3,92.86,92.86,96.3,8.33,33.33,100,100,50,50,50,100,100,100,86.36,15.15,0,0,15.38,40,40,88.46,88.46,71.43,72.41,37.5,72.22,90,90,36.84,31.58,9.09,9.09,6.67,6.67,6.67,6.67,6.67,57.14,57.14,33.33,35,36.84,69.23,69.23,92.86,88.24,82.35,12.5,44,44,24,3.33,null,26.09,26.09,18.18,29.41,57.14,72.73,75,75,78.95,87.5,80,80,72.73,0,73.33,66.67,86.36,69.57,68.48,90.27,0,0,75,16.67,23.08,0,8.33,64.71,61.54,60,60,60,35.29,0,25.93,31.58,26.47,26.47,53.57,53.57,37.5,37.5,55.56,55.56,90,18.75,100,100,0,0,53.33,56.67,50,53.85,18.18,12.9,84.21,84.21,3.7,21.43,21.43,0,7.41,7.41,0,0,0,0,72.73,69.57,88.24,88.24,18.18,18.18,88.89,60,63.16,73.68,73.68,23.08,23.08,33.33,85.71,87.5,0,31.58,31.58,0,0,26.09,62.5,38.89,80.95,80.95,0,0,17.39,18.6,18.18,26.32,25.64,0,66.67,66.67,84.62,84.62,25,21.05,8.33,22.22,22.22,23.81,86.36,86.36,82.61,82.61,65,68.42,10.71,10.71,28.57,84.62,84.62,87.5,84.62,43.48,83.87,78.57,6.67,61.11,61.11,52.17,52.17,16.67,7.14,86.67,6.45,6.45,90.48,90.48,88.89,88.89,38.71,90.48,89.66,38.46,38.46,89.66,90.48,93.75,93.75,80,80,12.5,3.85,3.85,30.3,0,0,10,0,27.27,27.27,68,71.43,71.43,81.48,88.46,88.46,35.71,80,96,40,16.67,16.67,50,50,17.39,17.39,17.39,17.39,33.33,33.33,89.47,88,88,80.77,0,31.58,31.58,31.58,13.33,13.33,48.28,46.67,55.17,55.17,39.29,14.29,10,0,0,10,80,80,10.34,84.62,84.62,18.18,18.18,35.71,35.71,85.71,91.3,91.3,77.27,0,7.69,7.69,100,100,100,100,25,16,16,10.71,14.29,7.14,30,42.86,42.86,42.86,42.86,4.55,89.47,15,82.61,82.61,47.06,41.18,30.77,74.07,74.07,36.36,36.36,30.3,30.3,37.14,37.14,25,25,42.86,42.86,50,82.76,84,12.5,12.5,59.09,83.33,83.33,14.29,14.29,26.09,78.26,82.61,80,0,0,0,0,84.62,67.86,6.9,3.85,10.53,37.5,37.5,0,35,72.73,100,95.24,95.24,36.36,45.83,45.83,76.92,76.92,28.57,26.09,42.86,23.33,22.58,4.17,52.17,53.33,47.37,47.37,64.71,64.71,90.91,0,0,52.17,76.47,76.47,100,21.43,7.14,7.14,42.31,42.31,40.74,40.74,65.38,82.86,82.86,0,0,0,0,0,0,80,80,60,75,75,4,4,91.43,0,0,12.5,12.5,100,100,83.33,86.96,24,28,70,70,80,80,20,null,null,0,81.25,31.25,31.25,88.89,88.89,0,0,20,20,100,100,0,21.05,21.05,86.36,86.36,83.33,83.33,78.95,78.95,71.43,71.43,90,90,100,0,8.7,89.47,89.47,4.17,4.17,17.65,22.22,22.22,22.22,22.22,54.55,0,100,100,17.65,17.65,21.43,23.08,100,100,55.56,29.41,100,100,75,75,0,16.67,16.67,95,85.71,3.23,65.62,81.82,80.95,94.12,94.12,7.69,31.25,31.25,14.81,14.29,6.9,66.67,66.67,35.29,33.33,42.11,25.93,8.7,8.7,0,12,4.76,40.91,40.91,0,50,50,8.33,25,25,20.83,8,40.91,40.91,39.13,39.13,58.82,58.82,60,0,11.54,11.54,94.44,94.44,94.44,94.44,0,4.17,90,94.12,57.89,57.89,74.07,74.07,35.71,47.06,48,48,14.29,7.69,66.67,76.47,0,0,0,90.91,90.91,93.55,93.55,28.57,3.45,3.45,35.29,35.29,35,30,29.41,72.41,17.86,55,22.73,34.48,34.48,92.86,88.89,88.89,5.56,38.46,38.46,55,55,61.11,33.33,0,0,8.7,8.7,75,75,75,43.33,60,60,85.71,89.29,0,47.83,70.97,93.33,93.1,95.65,95.65,30,22.58,0,0,85.71,86.21,50,14.29,20,10.53,90.91,90.91,52.17,52.17,17.65,15.79,66.67,66.67,18.18,18.18,86.36,86.36,63.16,65,80,89.66,95,84.21,88,69.23,10,72,0,85.19,85.19,40,40,36.36,40,48.15,48.15,64.29,81.25,81.25,55.17,51.61,90,90,0,21.43,27.27,55.56,7.14,5.88,43.48,43.48,43.48,32,60.87,60.87,10,10,34.78,26.92,20,43.48,14.29,96,0,14.29,14.29,37.5,37.5,93.33,93.33,0,0,20,23.08,27.59,83.33,83.33,0,79.17,13.33,4,4,4,4,4,13.79,13.79,33.33,44,44,84.85,84.85,8,null,47.06,47.06,77.78,53.12,12,11.11,9.52,9.52,93.33,93.33,5.26,5.26,10.53,5,48.15,70.59,70.59,20,4.76,55.56,50,90,90,12.5,0,77.78,77.78,60,9.09,90.91,9.09,5.56,100,5.56,20,11.11,100,90.48,60,60,83.33,83.33,82.14,82.14,75,75,10,50,50,0,0,0,0,52,52,35,35,25,26.32,18.75,60,58.82,81.48,0,83.33,66.67,26.32,14.29,50,50,0,28.57,94.44,94.44,68.42,68.42,10.53,4.76,4.76,33.33,33.33,36.36,36.36,33.33,40.91,95.45,95.45,78.12,16.67,16.67,75,75,90.32,90.32,80.65,78.12,28.12,47.62,45.45,77.78,61.11,63.16,63.16,0,69.57,69.57,73.91,73.91,32.14,95.83,95.83,16.67,19.05,22.73,22.73,81.82,77.27,16.13,20,16.67,16.67,50,47.37,75,85,85,40.91,40.91,100,100,59.09,59.09,59.09,57.14,83.33,75,83.33,62.96,62.96,77.27,73.91,7.69,20.69,0,68.75,68.75,29.41,29.41,76.47,72.22,47.06,47.06,41.67,41.67,70,50,22.73,52,52,39.13,39.13,23.08,29.63,29.63,4.76,4.76,0,90.48,90.48,29.63,16.67,71.43,71.43,72.73,72.73,0,0,0,0,55.56,55.56,90,90,58.33,58.33,15.38,15.38,95.83,95.83,23.53,0,9.68,91.67,91.67,42.86,83.87,84.38,78.12,78.12,94.74,40,40,94.74,68.42,77.27,77.27,95,95,0,0,8.33,8,22.22,22.22,16.67,20,50,57.89,10,81.25,81.25,86.36,86.36,90,47.62,47.62,47.62,80,72.73,72.73,16.67,66.67,66.67,77.78,85.71,85.71,100,14.29,0,0,20,4.35,4.76,42.31,66.67,66.67,50,33.33,36,100,100,0,0,11.76,11.76,42.86,47.62,50,48,30.43,16,16,66.67,66.67,100,53.85,84.62,79.17,71.43,2.94,2.94,45,45,20,20,48.15,44.44,84,84,41.67,41.67,38.46,38.46,64.71,64.71,53.33,53.33,0,90.48,90.48,12.5,91.3,91.3,0,78.26,78.26,95,95,76.67,11.11,11.11,11.11,10,10,10,10,10,54.55,54.55,25,7.69,8,56.52,56.52,8.33,8.33,23.08,23.08,14.29,7.69,94.74,0,0,14.29,88.89,88.89,58.33,20.83,20.83,34.48,34.48,62.07,0,59.09,59.09,null,25,25,70.59,0,0,44.44,41.18,7.14,16.67,16.67,14.29,20,87.5,87.5,86.96,86.96,78.95,77.78,77.78,59.26,59.26,4.17,4,79.31,79.31,7.69,4.17,22.22,39.39,39.39,31.43,31.43,77.78,77.78,50,50,47.06,47.06,47.06,47.06,12,50,50,5,0,0,3.33,3.33,0,11.11,50,0,0,0,96.43,55.17,55.17,20,100,100,69.23,69.23,23.81,23.81,0,40.62,40.62,40,75,75,0,83.33,88.89,95,95,96,96,0,0,10,10,8.7,10,3.33,3.57,3.57,92.31,92.31,76.92,44,100,40,60.87,71.43,33.33,28.12,7.14,91.3,91.67,30,29.03,18.18,18.18,20,20,11.11,59.26,59.26,78.79,75.68,70.37,87.5,37.5,37.5,95.24,95.24,95.24,95.24,25,25,35,72.41,72.41,0,0,75,75,80.95,0,32,45.83,45.83,20,20,25,10.53,0,18.75,18.75,78.95,84.21,40.91,43.48,65.71,87.88,13.04,12.5,100,100,0,0,0,0,10.53,25,25,28.57,56.52,0,0,92.86,75,75,93.75,93.75,7.14,10,9.09,9.09,9.09,9.09,9.09,9.09,9.09,50,0,59.26,59.26,5.56,5.56,100,100,51.52,51.52,83.33,81.82,81.82,4.17,4,4.76,4.17,96.15,96.15,70.37,38.46,100,9.52,13.33,13.33,80,80,90.91,70.59,100,100,91.89,91.89,85.71,85.71,70.59,35.48,90.48,85,0,0,0,52.94,77.78,25,77.27,77.27,83.33,83.33,84,84,48.15,48.15,100,100,100,100,88.46,88.46,88.89,88.89,100,100,91.67,87.5,90.91,90.91,100,42.11,42.11,50,50,46.67,46.67,100,100,28,28,85.71,89.29,86.96,69.57,68,76.19,72.73,66.67,60,60,60.71,60.71,3.33,65.22,65.22,52.17,52.17,33.33,70,20.83,20.83,70,9.09,17.86,25,19.35,57.14,15.79,50,50,20,79.17,61.9,61.9,55,55,75,96.88,75,96.97,92.86,92.86,22.86,56.25,56.25,60,20,96.15,96.15,80,84,84,84,21.74,21.74,50,91.3,91.3,8.33,23.08,11.11,65.38,78.26,45.45,45.45,85.71,85.71,9.09,52.63,55,28.57,81.82,21.43,6.67,7.14,68.18,54.17,50,46.15,8.7,52.78,52.78,52.78,50,41.67,53.85,61.9,61.9,50],[0,0,null,null,null,100,100,0,80,25,null,null,null,100,null,null,50,0,0,null,37.5,37.5,null,null,null,null,100,null,0,0,null,0,50,50,null,null,null,null,null,0,null,0,0,0,25,0,0,100,null,null,100,50,null,null,null,100,null,null,null,null,null,100,null,null,null,0,null,null,0,0,100,null,50,100,null,null,50,50,null,null,0,0,0,0,0,null,null,50,50,33.33,100,100,100,0,0,0,100,100,0,0,null,0,0,0,0,null,80,100,100,100,100,100,100,80,0,100,100,100,83.33,83.33,91.3,null,null,100,0,0,0,0,80,null,100,100,100,null,0,null,33.33,null,null,50,50,null,null,null,null,66.67,25,66.67,66.67,0,0,50,50,null,null,25,0,100,100,50,0,0,25,0,0,0,0,0,0,100,100,0,0,0,0,100,null,null,100,100,0,0,0,33.33,0,25,null,null,null,null,null,50,null,null,null,0,0,0,0,0,0,0,0,100,100,100,100,0,40,null,0,0,20,66.67,66.67,100,100,50,33.33,null,null,null,75,75,66.67,75,0,71.43,0,0,100,100,0,0,0,0,60,null,null,null,null,0,0,66.67,100,75,null,null,75,100,100,100,null,null,0,100,100,0,0,0,null,0,14.29,14.29,0,null,null,75,100,100,100,null,75,0,0,0,null,null,0,0,0,0,0,0,100,100,100,100,0,null,null,null,0,0,50,50,100,100,20,0,0,0,0,0,100,100,null,null,null,0,0,0,0,100,null,null,60,null,0,0,100,100,100,100,null,null,null,100,0,0,50,null,null,null,null,0,66.67,50,100,100,66.67,66.67,0,100,100,null,null,100,100,null,null,null,null,100,100,null,100,null,0,null,0,100,100,50,50,0,100,100,33.33,0,0,null,0,100,66.67,0,null,0,0,0,20,42.86,40,100,100,100,null,0,0,null,null,0,0,0,0,0,0,null,null,null,null,100,100,33.33,0,0,66.67,null,null,100,0,null,null,0,0,0,0,28.57,100,100,0,0,0,0,0,0,100,100,50,null,null,0,0,100,0,0,0,0,null,null,50,50,0,0,100,100,50,50,0,null,null,20,null,50,50,100,100,0,0,0,0,100,null,null,50,50,100,100,null,null,100,100,0,0,50,50,100,50,0,100,100,33.33,33.33,50,0,0,0,0,50,null,100,100,null,null,null,null,50,50,null,0,100,100,25,25,0,null,null,66.67,66.67,0,0,50,62.5,null,null,0,0,0,0,0,0,0,0,0,0,0,null,0,0,null,0,25,50,50,0,50,50,100,0,0,0,0,null,null,null,null,0,0,50,0,0,0,null,null,null,null,0,0,100,80,100,100,100,100,33.33,11.11,0,0,100,0,100,100,0,0,null,100,100,100,100,100,0,0,33.33,33.33,null,null,33.33,100,0,100,0,null,null,100,100,100,0,50,50,50,50,33.33,null,null,null,0,0,50,null,null,33.33,null,null,0,0,null,40,0,null,100,100,100,36.36,null,null,null,100,null,0,0,null,0,null,null,20,20,0,0,50,50,0,0,100,100,100,null,100,100,100,0,100,100,0,50,null,null,null,0,0,null,null,0,0,50,100,100,33.33,66.67,100,100,0,0,0,12.5,0,0,100,100,100,0,100,100,0,0,0,0,14.29,50,100,100,null,null,null,0,0,100,100,null,null,null,null,100,80,80,0,100,null,0,0,0,0,0,0,0,0,null,null,null,null,null,null,100,100,100,0,50,40,0,0,100,100,null,null,null,0,33.33,0,0,0,0,100,100,100,100,100,null,null,null,25,66.67,50,null,0,100,0,0,66.67,100,50,null,null,50,50,100,100,100,100,100,null,null,null,0,null,null,100,100,null,null,25,20,0,66.67,100,null,null,50,50,null,null,100,100,25,null,100,100,50,50,0,null,null,0,0,0,0,0,100,null,null,100,null,null,0,0,0,0,0,null,0,0,0,null,null,100,100,0,80,80,66.67,66.67,0,50,50,33.33,16.67,0,0,null,null,null,0,0,0,66.67,66.67,100,50,50,33.33,33.33,100,100,100,100,100,100,100,0,100,100,100,50,50,0,0,null,null,null,100,100,0,null,0,0,33.33,33.33,null,null,0,100,100,null,null,0,0,0,0,0,0,0,0,null,null,100,100,100,100,null,null,null,null,null,null,0,0,null,null,null,null,null,null,null,null,null,100,100,0,100,100,100,100,50,100,100,100,100,null,null,50,50,null,null,0,0,null,null,null,null,0,50,null,33.33,33.33,100,100,100,null,null,null,null,0,0,0,null,null,0,100,100,0,0,0,0,null,0,0,50,null,null,0,100,100,null,null,null,null,null,null,null,null,null,null,50,null,null,100,100,100,null,null,100,100,100,100,100,100,null,null,0,0,100,100,null,null,null,null,100,100,100,100,null,100,100,null,100,100,0,100,100,50,50,null,0,0,0,0,0,0,0,0,33.33,33.33,null,0,0,66.67,66.67,0,0,null,null,0,50,100,null,null,0,null,null,50,0,0,0,0,0,0,100,100,null,25,25,66.67,0,0,100,50,0,14.29,14.29,50,50,100,100,80,80,75,100,100,66.67,66.67,0,0,100,100,9.09,null,0,0,0,0,0,null,null,null,null,0,0,0,0,null,null,null,0,null,null,0,0,0,null,0,0,null,null,100,100,100,0,null,null,50,50,8.33,8.33,null,0,0,25,85.71,85.71,0,100,100,null,null,100,100,0,0,0,0,null,0,0,0,0,100,100,50,0,100,0,null,null,null,null,0,50,0,null,0,0,0,80,100,25,66.67,66.67,33.33,0,null,100,50,50,100,100,100,100,0,0,0,66.67,66.67,null,null,100,100,100,0,50,33.33,33.33,null,null,null,null,100,0,0,50,50,null,null,33.33,null,0,null,100,100,null,null,null,null,0,0,0,100,null,null,null,0,100,100,100,100,null,null,null,null,null,null,null,null,null,66.67,0,null,null,null,null,100,100,null,null,100,100,100,0,null,20,0,0,0,100,null,null,null,0,0,0,0,0,null,null,null,100,100,100,100,null,null,null,null,0,0,0,50,50,0,75,75,50,50,100,100,null,null,0,0,null,null,100,66.67,100,100,100,100,100,100,50,50,100,null,null,33.33,33.33,0,0,75,75,33.33,33.33,100,100,null,66.67,50,100,100,100,100,100,100,100,0,33.33,33.33,100,100,null,0,75,75,0,0,100,100,0,100,0,null,null,null,100,null,null,100,100,66.67,100,66.67,100,50,50,100,66.67,66.67,null,100,0,0,null,null,null,null,33.33,33.33,33.33,0,0,null,0,0,100,null,0,0,100,100,0,0,null,0,100,0,null,0,100,null,100,100,null,null,null,null,null,100,33.33,100,100,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>motifsite<\/th>\n      <th>#of_fp_detected_in_methy_group<\/th>\n      <th>#of_fp_detected_in_non-methy_group<\/th>\n      <th>#of_no_fp_reads_in_methy_group<\/th>\n      <th>#of_no_fp_reads_in_non-methy_group<\/th>\n      <th>%of_fp_detected_in_methy_group<\/th>\n      <th>%of_fp_detected_in_non-methy_group<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>df_long &lt;- mat[,1:2] %&gt;%
  pivot_longer(cols = everything(), names_to = &quot;CpG&quot;, values_to = &quot;% of Footprint&quot;)

ggplot(df_long, aes(x = CpG, y = `% of Footprint`, fill = `% of Footprint`)) +
  geom_boxplot() +
  theme_minimal()</code></pre>
<p><img src="figure/TF_co-acc_NRF1_pairs_cpg.Rmd/unnamed-chunk-19-2.png" width="480" style="display: block; margin: auto;" /></p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.0 (2022-04-22)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: CentOS Linux 7 (Core)

Matrix products: default
BLAS/LAPACK: /software/openblas-0.3.13-el7-x86_64/lib/libopenblas_haswellp-r0.3.13.so

locale:
[1] C

attached base packages:
[1] stats4    stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] Biostrings_2.64.0    XVector_0.36.0       gridExtra_2.3       
 [4] forcats_0.5.1        stringr_1.5.1        dplyr_1.1.4         
 [7] purrr_1.0.2          readr_2.1.2          tidyr_1.3.0         
[10] tibble_3.2.1         tidyverse_1.3.1      ggplot2_3.5.1       
[13] GenomicRanges_1.48.0 GenomeInfoDb_1.39.9  IRanges_2.30.0      
[16] S4Vectors_0.34.0     BiocGenerics_0.42.0  reshape2_1.4.4      
[19] data.table_1.14.2   

loaded via a namespace (and not attached):
 [1] bitops_1.0-7           fs_1.5.2               lubridate_1.8.0       
 [4] httr_1.4.3             rprojroot_2.0.3        tools_4.2.0           
 [7] backports_1.4.1        bslib_0.3.1            utf8_1.2.2            
[10] R6_2.5.1               DT_0.22                DBI_1.2.2             
[13] colorspace_2.0-3       withr_2.5.0            tidyselect_1.2.0      
[16] compiler_4.2.0         git2r_0.30.1           cli_3.6.1             
[19] rvest_1.0.2            xml2_1.3.3             labeling_0.4.2        
[22] sass_0.4.1             scales_1.3.0           digest_0.6.29         
[25] rmarkdown_2.25         pkgconfig_2.0.3        htmltools_0.5.2       
[28] dbplyr_2.1.1           fastmap_1.1.0          highr_0.9             
[31] htmlwidgets_1.5.4      rlang_1.1.2            readxl_1.4.0          
[34] rstudioapi_0.13        jquerylib_0.1.4        generics_0.1.2        
[37] farver_2.1.0           jsonlite_1.8.0         crosstalk_1.2.0       
[40] RCurl_1.98-1.7         magrittr_2.0.3         GenomeInfoDbData_1.2.8
[43] Rcpp_1.0.12            munsell_0.5.0          fansi_1.0.3           
[46] lifecycle_1.0.4        stringi_1.7.6          yaml_2.3.5            
[49] zlibbioc_1.42.0        plyr_1.8.7             grid_4.2.0            
[52] promises_1.2.0.1       crayon_1.5.1           haven_2.5.0           
[55] cowplot_1.1.1          hms_1.1.1              knitr_1.39            
[58] pillar_1.9.0           reprex_2.0.1           glue_1.6.2            
[61] evaluate_0.15          modelr_0.1.8           vctrs_0.6.5           
[64] tzdb_0.4.0             httpuv_1.6.5           cellranger_1.1.0      
[67] gtable_0.3.0           assertthat_0.2.1       xfun_0.41             
[70] broom_0.8.0            later_1.3.0            workflowr_1.7.0       
[73] ellipsis_0.3.2        </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
